var Ma=Object.defineProperty;var Da=(n,e,t)=>e in n?Ma(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Jt=(n,e,t)=>Da(n,typeof e!="symbol"?e+"":e,t);import{j as o,y as Ba,n as Ua,a as qa,b as Ha,c as ze,s as Ka,d as B,e as Wa,f as Ja,g as za,h as Va,m as cr,i as Q,k as _t,l as Z,o as ie,p as zr,q as Xa,r as Ga,t as Ya,u as Qa,v as zt,w as Vt,x as Za,z as ei,A as ti,N as Vr,$ as ni}from"./ui-vendor-CNYFKYwT.js";import{a as ri,r as P,R as nt,u as je,L as pe,B as si,b as ai,c as be,N as ii}from"./react-vendor-C666tPDI.js";import{i as oi,g as li,a as ci,s as ui,c as di,b as ur,d as Xt,e as Gt,f as fi,h as hi,F as Xr}from"./firebase-vendor-HfOr0Lxv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var Gr,dr=ri;Gr=dr.createRoot,dr.hydrateRoot;const Yr={apiKey:"AIzaSyC_6b6SR-a6Whq5IxWnQKxpO2-NmhHLKos",authDomain:"podcastgen-96b48.firebaseapp.com",projectId:"podcastgen-96b48",storageBucket:"podcastgen-96b48.appspot.com",messagingSenderId:"77991556150",appId:"1:77991556150:web:b0722fc1fb87f9fce59497",measurementId:"G-P6G11L88JF"};if(!Yr.apiKey)throw new Error("Firebase configuration is missing. Please check your environment variables.");const Qr=oi(Yr),pt=li(Qr),Yt=ci(Qr);async function mi(n,e,t){let r;for(let s=1;s<=e;s++)try{return await n()}catch(a){console.error(`Attempt ${s} failed:`,a),r=a,s<e&&await new Promise(i=>setTimeout(i,t))}throw r}const Zr=P.createContext(void 0),Ae=()=>{const n=P.useContext(Zr);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},pi=({children:n})=>{const[e,t]=P.useState(null),[r,s]=P.useState(navigator.onLine);P.useEffect(()=>{const u=pt.onAuthStateChanged(p=>{t(p)}),w=()=>s(!0),y=()=>s(!1);return window.addEventListener("online",w),window.addEventListener("offline",y),()=>{u(),window.removeEventListener("online",w),window.removeEventListener("offline",y)}},[]);const f={user:e,login:async(u,w)=>{try{await ui(pt,u,w)}catch(y){throw console.error("Login error:",y),y}},register:async(u,w)=>{try{const y=await di(pt,u,w);await ur(Xt(Gt(Yt,"users"),y.user.uid),{email:u,createdAt:new Date().toISOString()})}catch(y){throw console.error("Registration error:",y),y}},logout:async()=>{try{await fi(pt)}catch(u){throw console.error("Logout error:",u),u}},getApiKeys:async()=>{if(!e)return console.log("getApiKeys: No user logged in"),null;if(!r)throw console.log("getApiKeys: Device is offline"),new Error("You are currently offline. Please check your internet connection and try again.");try{return console.log("Fetching API keys for user:",e.uid),await mi(async()=>{const w=Xt(Gt(Yt,"users"),e.uid),y=await hi(w);if(y.exists()){const p=y.data();return console.log("API keys retrieved:",{openaiKey:p.OPENAI_API_KEY?"[REDACTED]":"Not set",perplexityKey:p.Perplexity_API_KEY?"[REDACTED]":"Not set"}),{openaiKey:p.OPENAI_API_KEY||"",perplexityKey:p.Perplexity_API_KEY||""}}return console.log("No API keys found for user"),null},3,1e3)}catch(u){throw u instanceof Xr?(console.error("Firebase error details:",u.code,u.message),new Error(`Failed to retrieve API keys: ${u.code} - ${u.message}`)):u instanceof Error?new Error(`Failed to retrieve API keys: ${u.message}`):new Error("Failed to retrieve API keys due to an unknown error")}},setApiKeys:async(u,w)=>{if(!e)throw new Error("No user logged in");if(!r)throw new Error("You are currently offline. Please check your internet connection and try again.");try{const y=Xt(Gt(Yt,"users"),e.uid);await ur(y,{OPENAI_API_KEY:u,Perplexity_API_KEY:w},{merge:!0})}catch(y){throw console.error("Error setting API keys:",y),y}},isOnline:r};return o.jsx(Zr.Provider,{value:f,children:n})},Lt=nt.createContext({config:null,transcript:"",audioUrl:"",setPodcastConfig:()=>{},setTranscript:()=>{},setAudioUrl:()=>{}});class gi extends P.Component{constructor(){super(...arguments);Jt(this,"state",{hasError:!1,error:null,errorInfo:null});Jt(this,"handleReload",()=>{window.location.reload()})}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("[ErrorBoundary]: Caught error:",t),console.error("[ErrorBoundary]: Error info:",r),this.setState({error:t,errorInfo:r})}render(){var t;return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[o.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error. You can try reloading the page."}),o.jsx("button",{onClick:this.handleReload,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors mb-6",children:"Reload Page"}),this.state.error&&o.jsxs("div",{className:"mt-4",children:[o.jsx("p",{className:"font-semibold text-gray-700 mb-2",children:"Error Details:"}),o.jsxs("pre",{className:"bg-gray-50 p-4 rounded overflow-auto max-h-[200px] text-sm",children:[this.state.error.toString(),(t=this.state.errorInfo)==null?void 0:t.componentStack]})]})]})}):this.props.children}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),z=(n,e)=>{const t=P.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:l="",children:d,...c},f)=>P.createElement("svg",{ref:f,...yi,width:s,height:s,stroke:r,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${wi(n)}`,l].join(" "),...c},[...e.map(([u,w])=>P.createElement(u,w)),...Array.isArray(d)?d:[d]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=z("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=z("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=z("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=z("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=z("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=z("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=z("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=z("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=z("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=z("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=z("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=z("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=z("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=z("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=z("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),Ni=()=>{var i;const{user:n,logout:e}=Ae(),t=je(),{theme:r,setTheme:s}=Ba(),a=async()=>{try{await e(),t("/login")}catch(l){console.error("Failed to log out",l)}};return o.jsxs(Ua,{maxWidth:"full",className:"shadow-lg",children:[o.jsx(qa,{children:o.jsxs(pe,{to:"/",className:"flex items-center gap-2",children:[o.jsx(rs,{size:24}),o.jsx("p",{className:"font-bold text-inherit",children:"PodcastGen"})]})}),o.jsxs(Ha,{justify:"end",children:[o.jsx(ze,{children:o.jsx(Ka,{defaultSelected:r==="dark",size:"lg",color:"primary",startContent:o.jsx(Ci,{}),endContent:o.jsx(Ai,{}),onChange:l=>s(l.target.checked?"dark":"light")})}),o.jsx(ze,{children:o.jsx(pe,{to:"/",children:o.jsx(B,{variant:"light",children:"Home"})})}),n?o.jsxs(o.Fragment,{children:[o.jsx(ze,{children:o.jsx(pe,{to:"/config",children:o.jsx(B,{variant:"light",children:"Generate"})})}),o.jsxs(Wa,{placement:"bottom-end",children:[o.jsx(Ja,{children:o.jsx(za,{isBordered:!0,as:"button",className:"transition-transform",color:"primary",name:(i=n.email)==null?void 0:i.charAt(0).toUpperCase(),size:"sm"})}),o.jsxs(Va,{"aria-label":"Profile Actions",variant:"flat",children:[o.jsx(cr,{onPress:()=>t("/profile"),children:"Profile"},"profile"),o.jsx(cr,{color:"danger",onPress:a,children:"Log Out"},"logout")]})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(ze,{children:o.jsx(pe,{to:"/login",children:o.jsx(B,{variant:"light",children:"Login"})})}),o.jsx(ze,{children:o.jsx(pe,{to:"/register",children:o.jsx(B,{color:"primary",variant:"flat",children:"Sign Up"})})})]})]})]})},ji=()=>o.jsx("footer",{className:"bg-gray-800 text-white py-6 mt-auto",children:o.jsx("div",{className:"container mx-auto px-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[o.jsxs("div",{className:"mb-4 md:mb-0",children:[o.jsx("p",{className:"text-lg font-semibold",children:"PodcastGen"}),o.jsx("p",{className:"text-sm text-gray-400",children:"Create amazing podcasts with AI"})]}),o.jsxs("div",{className:"text-sm text-gray-400",children:["© ",new Date().getFullYear()," PodcastGen. All rights reserved."]})]})})}),ki=()=>{const{user:n}=Ae();return o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h1",{className:"text-5xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-violet-600 bg-clip-text text-transparent",children:"Welcome to PodcastGen"}),o.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Generate amazing podcasts with AI-powered voices and content"}),n?o.jsx(pe,{to:"/config",children:o.jsx(B,{color:"primary",size:"lg",className:"font-semibold",children:"Start Creating"})}):o.jsxs("div",{className:"space-x-4",children:[o.jsx(pe,{to:"/login",children:o.jsx(B,{color:"primary",variant:"flat",size:"lg",children:"Login"})}),o.jsx(pe,{to:"/register",children:o.jsx(B,{color:"primary",size:"lg",children:"Register"})})]})]}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mt-12",children:[o.jsxs(Q,{className:"p-4",children:[o.jsxs(_t,{className:"pb-0 pt-2 px-4 flex-col items-start",children:[o.jsx("div",{className:"rounded-full bg-primary-100 p-3 mb-4",children:o.jsx(rs,{className:"text-primary h-6 w-6"})}),o.jsx("h2",{className:"font-bold text-xl",children:"Professional Voices"})]}),o.jsx(Z,{children:o.jsx("p",{className:"text-gray-600",children:"Choose from a variety of high-quality AI voices to bring your content to life"})})]}),o.jsxs(Q,{className:"p-4",children:[o.jsxs(_t,{className:"pb-0 pt-2 px-4 flex-col items-start",children:[o.jsx("div",{className:"rounded-full bg-primary-100 p-3 mb-4",children:o.jsx(ss,{className:"text-primary h-6 w-6"})}),o.jsx("h2",{className:"font-bold text-xl",children:"AI-Powered Content"})]}),o.jsx(Z,{children:o.jsx("p",{className:"text-gray-600",children:"Generate engaging scripts and conversations with advanced AI technology"})})]}),o.jsxs(Q,{className:"p-4",children:[o.jsxs(_t,{className:"pb-0 pt-2 px-4 flex-col items-start",children:[o.jsx("div",{className:"rounded-full bg-primary-100 p-3 mb-4",children:o.jsx(Pi,{className:"text-primary h-6 w-6"})}),o.jsx("h2",{className:"font-bold text-xl",children:"Multiple Hosts"})]}),o.jsx(Z,{children:o.jsx("p",{className:"text-gray-600",children:"Create dynamic conversations between multiple AI hosts for engaging podcasts"})})]})]})]})},Oi=()=>{const[n,e]=P.useState(""),[t,r]=P.useState(""),[s,a]=P.useState(""),{login:i}=Ae(),l=je(),d=async c=>{c.preventDefault(),a("");try{await i(n,t),l("/config")}catch(f){console.error("Login error:",f),f instanceof Error?f.message.includes("network-request-failed")?a("Network error. Please check your internet connection and try again."):a("Failed to log in. Please check your credentials and try again."):a("An unexpected error occurred. Please try again.")}};return o.jsx("div",{className:"max-w-md mx-auto mt-10 px-4",children:o.jsx(Q,{className:"p-6",children:o.jsxs(Z,{children:[o.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"Welcome Back"}),s&&o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:s}),o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsx(ie,{type:"email",label:"Email",placeholder:"Enter your email",value:n,onChange:c=>e(c.target.value),startContent:o.jsx(ns,{className:"text-gray-400",size:20}),required:!0}),o.jsx(ie,{type:"password",label:"Password",placeholder:"Enter your password",value:t,onChange:c=>r(c.target.value),startContent:o.jsx(hn,{className:"text-gray-400",size:20}),required:!0}),o.jsx(B,{type:"submit",color:"primary",className:"w-full",size:"lg",children:"Login"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",o.jsx(zr,{as:pe,to:"/register",color:"primary",children:"Register here"})]})})]})})})},Ii=()=>{const[n,e]=P.useState(""),[t,r]=P.useState(""),[s,a]=P.useState(""),[i,l]=P.useState(""),{register:d}=Ae(),c=je(),f=async u=>{if(u.preventDefault(),l(""),t!==s){l("Passwords don't match");return}try{await d(n,t),c("/config")}catch(w){if(console.error("Registration error:",w),w instanceof Xr)switch(w.code){case"auth/email-already-in-use":l("This email is already registered. Please use a different email or try logging in.");break;case"auth/invalid-email":l("Invalid email address. Please check and try again.");break;case"auth/weak-password":l("Password is too weak. Please use a stronger password.");break;case"auth/network-request-failed":l("Network error. Please check your internet connection and try again.");break;default:l("Failed to create an account. Please try again.")}else l("An unexpected error occurred. Please try again.")}};return o.jsx("div",{className:"max-w-md mx-auto mt-10 px-4",children:o.jsx(Q,{className:"p-6",children:o.jsxs(Z,{children:[o.jsx("div",{className:"flex justify-center mb-6",children:o.jsx(vi,{size:40,className:"text-primary"})}),o.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"Create Account"}),i&&o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:i}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsx(ie,{type:"email",label:"Email",placeholder:"Enter your email",value:n,onChange:u=>e(u.target.value),startContent:o.jsx(ns,{className:"text-gray-400",size:20}),required:!0}),o.jsx(ie,{type:"password",label:"Password",placeholder:"Enter your password",value:t,onChange:u=>r(u.target.value),startContent:o.jsx(hn,{className:"text-gray-400",size:20}),required:!0}),o.jsx(ie,{type:"password",label:"Confirm Password",placeholder:"Confirm your password",value:s,onChange:u=>a(u.target.value),startContent:o.jsx(hn,{className:"text-gray-400",size:20}),required:!0}),o.jsx(B,{type:"submit",color:"primary",className:"w-full",size:"lg",children:"Register"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",o.jsx(zr,{as:pe,to:"/login",color:"primary",children:"Login here"})]})})]})})})},Ti=()=>{const{user:n,logout:e,setApiKeys:t,getApiKeys:r,isOnline:s}=Ae(),a=je(),[i,l]=P.useState(""),[d,c]=P.useState(""),[f,u]=P.useState(""),[w,y]=P.useState(""),[p,m]=P.useState(!0);P.useState(!1),P.useEffect(()=>{(async()=>{if(!s){y("You are currently offline. API keys cannot be retrieved."),m(!1);return}try{m(!0),u("Retrieving API keys...");const b=await r();b?(l(b.openaiKey),c(b.perplexityKey),u("API keys loaded successfully.")):u("No API keys found. Please set your API keys.")}catch(b){console.error("Error fetching API keys:",b),b instanceof Error?y(`Failed to retrieve API keys: ${b.message}`):y("Failed to retrieve API keys. Please check your connection and try again.")}finally{m(!1)}})()},[r,s]);const g=async()=>{try{await e(),a("/login")}catch(x){console.error("Failed to log out",x),y("Failed to log out. Please try again.")}},v=async x=>{x.preventDefault(),u(""),y("");try{await t(i,d),u("API keys updated successfully"),a("/config")}catch(b){console.error("Failed to update API keys",b),y("Failed to update API keys. Please try again.")}};return n?o.jsx("div",{className:"max-w-2xl mx-auto mt-10 px-4",children:o.jsx(Q,{className:"mb-6",children:o.jsxs(Z,{children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Profile Settings"}),o.jsx("div",{className:"mb-4",children:o.jsxs("p",{className:"text-gray-600",children:["Email: ",n.email]})}),w&&o.jsxs("div",{className:"flex items-center gap-2 p-4 mb-4 bg-danger-50 text-danger rounded-lg",children:[o.jsx(es,{size:20}),o.jsx("p",{children:w})]}),f&&o.jsx("div",{className:"p-4 mb-4 bg-success-50 text-success rounded-lg",children:o.jsx("p",{children:f})}),o.jsx(Xa,{children:o.jsx(Ga,{"aria-label":"API Key Instructions",title:"How to Get Your API Keys",className:"mb-4",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"OpenAI API Key"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[o.jsxs("li",{children:["Visit ",o.jsx("a",{href:"https://platform.openai.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:"platform.openai.com"})]}),o.jsx("li",{children:"Log in to your account"}),o.jsx("li",{children:"Click your profile icon in the top-right corner"}),o.jsx("li",{children:'Select "API Keys" from the dropdown menu'}),o.jsx("li",{children:'Click "Create new secret key"'}),o.jsx("li",{children:"Copy your API key immediately"})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Perplexity API Key"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[o.jsxs("li",{children:["Visit ",o.jsx("a",{href:"https://www.perplexity.ai",target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:"www.perplexity.ai"})]}),o.jsx("li",{children:"Log in to your account"}),o.jsx("li",{children:"Go to Settings in the bottom-left corner"}),o.jsx("li",{children:"Click on the API tab"}),o.jsx("li",{children:"Generate or copy your API key"})]})]})]})},"api-instructions")}),p?o.jsxs("div",{className:"flex items-center justify-center p-4",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"}),o.jsx("span",{className:"ml-2 text-primary",children:"Loading..."})]}):o.jsxs("form",{onSubmit:v,className:"space-y-4",children:[o.jsx(ie,{type:"password",label:"OpenAI API Key",placeholder:"sk-...",value:i,onChange:x=>l(x.target.value),startContent:o.jsx(fr,{className:"text-gray-400",size:20})}),o.jsx(ie,{type:"password",label:"Perplexity API Key",placeholder:"pplx-...",value:d,onChange:x=>c(x.target.value),startContent:o.jsx(fr,{className:"text-gray-400",size:20})}),o.jsx(B,{type:"submit",color:"primary",className:"w-full",size:"lg",children:"Update API Keys"})]}),o.jsx(Ya,{className:"my-6"}),o.jsx(B,{color:"danger",variant:"flat",className:"w-full",size:"lg",startContent:o.jsx(Si,{}),onPress:g,children:"Logout"})]})})}):(a("/login"),null)};function as(n,e){return function(){return n.apply(e,arguments)}}const{toString:Fi}=Object.prototype,{getPrototypeOf:Tn}=Object,$t=(n=>e=>{const t=Fi.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),de=n=>(n=n.toLowerCase(),e=>$t(e)===n),Mt=n=>e=>typeof e===n,{isArray:qe}=Array,at=Mt("undefined");function Li(n){return n!==null&&!at(n)&&n.constructor!==null&&!at(n.constructor)&&ae(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const is=de("ArrayBuffer");function $i(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&is(n.buffer),e}const Mi=Mt("string"),ae=Mt("function"),os=Mt("number"),Dt=n=>n!==null&&typeof n=="object",Di=n=>n===!0||n===!1,St=n=>{if($t(n)!=="object")return!1;const e=Tn(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Bi=de("Date"),Ui=de("File"),qi=de("Blob"),Hi=de("FileList"),Ki=n=>Dt(n)&&ae(n.pipe),Wi=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ae(n.append)&&((e=$t(n))==="formdata"||e==="object"&&ae(n.toString)&&n.toString()==="[object FormData]"))},Ji=de("URLSearchParams"),[zi,Vi,Xi,Gi]=["ReadableStream","Request","Response","Headers"].map(de),Yi=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function lt(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),qe(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const a=t?Object.getOwnPropertyNames(n):Object.keys(n),i=a.length;let l;for(r=0;r<i;r++)l=a[r],e.call(null,n[l],l,n)}}function ls(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,cs=n=>!at(n)&&n!==Ce;function mn(){const{caseless:n}=cs(this)&&this||{},e={},t=(r,s)=>{const a=n&&ls(e,s)||s;St(e[a])&&St(r)?e[a]=mn(e[a],r):St(r)?e[a]=mn({},r):qe(r)?e[a]=r.slice():e[a]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&lt(arguments[r],t);return e}const Qi=(n,e,t,{allOwnKeys:r}={})=>(lt(e,(s,a)=>{t&&ae(s)?n[a]=as(s,t):n[a]=s},{allOwnKeys:r}),n),Zi=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),eo=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},to=(n,e,t,r)=>{let s,a,i;const l={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),a=s.length;a-- >0;)i=s[a],(!r||r(i,n,e))&&!l[i]&&(e[i]=n[i],l[i]=!0);n=t!==!1&&Tn(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},no=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},ro=n=>{if(!n)return null;if(qe(n))return n;let e=n.length;if(!os(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},so=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Tn(Uint8Array)),ao=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=r.next())&&!s.done;){const a=s.value;e.call(n,a[0],a[1])}},io=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},oo=de("HTMLFormElement"),lo=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),hr=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),co=de("RegExp"),us=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};lt(t,(s,a)=>{let i;(i=e(s,a,n))!==!1&&(r[a]=i||s)}),Object.defineProperties(n,r)},uo=n=>{us(n,(e,t)=>{if(ae(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ae(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},fo=(n,e)=>{const t={},r=s=>{s.forEach(a=>{t[a]=!0})};return qe(n)?r(n):r(String(n).split(e)),t},ho=()=>{},mo=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e,Qt="abcdefghijklmnopqrstuvwxyz",mr="0123456789",ds={DIGIT:mr,ALPHA:Qt,ALPHA_DIGIT:Qt+Qt.toUpperCase()+mr},po=(n=16,e=ds.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function go(n){return!!(n&&ae(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const yo=n=>{const e=new Array(10),t=(r,s)=>{if(Dt(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const a=qe(r)?[]:{};return lt(r,(i,l)=>{const d=t(i,s+1);!at(d)&&(a[l]=d)}),e[s]=void 0,a}}return r};return t(n,0)},wo=de("AsyncFunction"),xo=n=>n&&(Dt(n)||ae(n))&&ae(n.then)&&ae(n.catch),fs=((n,e)=>n?setImmediate:e?((t,r)=>(Ce.addEventListener("message",({source:s,data:a})=>{s===Ce&&a===t&&r.length&&r.shift()()},!1),s=>{r.push(s),Ce.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ae(Ce.postMessage)),bo=typeof queueMicrotask<"u"?queueMicrotask.bind(Ce):typeof process<"u"&&process.nextTick||fs,h={isArray:qe,isArrayBuffer:is,isBuffer:Li,isFormData:Wi,isArrayBufferView:$i,isString:Mi,isNumber:os,isBoolean:Di,isObject:Dt,isPlainObject:St,isReadableStream:zi,isRequest:Vi,isResponse:Xi,isHeaders:Gi,isUndefined:at,isDate:Bi,isFile:Ui,isBlob:qi,isRegExp:co,isFunction:ae,isStream:Ki,isURLSearchParams:Ji,isTypedArray:so,isFileList:Hi,forEach:lt,merge:mn,extend:Qi,trim:Yi,stripBOM:Zi,inherits:eo,toFlatObject:to,kindOf:$t,kindOfTest:de,endsWith:no,toArray:ro,forEachEntry:ao,matchAll:io,isHTMLForm:oo,hasOwnProperty:hr,hasOwnProp:hr,reduceDescriptors:us,freezeMethods:uo,toObjectSet:fo,toCamelCase:lo,noop:ho,toFiniteNumber:mo,findKey:ls,global:Ce,isContextDefined:cs,ALPHABET:ds,generateString:po,isSpecCompliantForm:go,toJSONObject:yo,isAsyncFn:wo,isThenable:xo,setImmediate:fs,asap:bo};function R(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}h.inherits(R,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:h.toJSONObject(this.config),code:this.code,status:this.status}}});const hs=R.prototype,ms={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{ms[n]={value:n}});Object.defineProperties(R,ms);Object.defineProperty(hs,"isAxiosError",{value:!0});R.from=(n,e,t,r,s,a)=>{const i=Object.create(hs);return h.toFlatObject(n,i,function(d){return d!==Error.prototype},l=>l!=="isAxiosError"),R.call(i,n.message,e,t,r,s),i.cause=n,i.name=n.name,a&&Object.assign(i,a),i};const _o=null;function pn(n){return h.isPlainObject(n)||h.isArray(n)}function ps(n){return h.endsWith(n,"[]")?n.slice(0,-2):n}function pr(n,e,t){return n?n.concat(e).map(function(s,a){return s=ps(s),!t&&a?"["+s+"]":s}).join(t?".":""):e}function So(n){return h.isArray(n)&&!n.some(pn)}const Ao=h.toFlatObject(h,{},null,function(e){return/^is[A-Z]/.test(e)});function Bt(n,e,t){if(!h.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=h.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!h.isUndefined(g[m])});const r=t.metaTokens,s=t.visitor||f,a=t.dots,i=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&h.isSpecCompliantForm(e);if(!h.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(h.isDate(p))return p.toISOString();if(!d&&h.isBlob(p))throw new R("Blob is not supported. Use a Buffer instead.");return h.isArrayBuffer(p)||h.isTypedArray(p)?d&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function f(p,m,g){let v=p;if(p&&!g&&typeof p=="object"){if(h.endsWith(m,"{}"))m=r?m:m.slice(0,-2),p=JSON.stringify(p);else if(h.isArray(p)&&So(p)||(h.isFileList(p)||h.endsWith(m,"[]"))&&(v=h.toArray(p)))return m=ps(m),v.forEach(function(b,_){!(h.isUndefined(b)||b===null)&&e.append(i===!0?pr([m],_,a):i===null?m:m+"[]",c(b))}),!1}return pn(p)?!0:(e.append(pr(g,m,a),c(p)),!1)}const u=[],w=Object.assign(Ao,{defaultVisitor:f,convertValue:c,isVisitable:pn});function y(p,m){if(!h.isUndefined(p)){if(u.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));u.push(p),h.forEach(p,function(v,x){(!(h.isUndefined(v)||v===null)&&s.call(e,v,h.isString(x)?x.trim():x,m,w))===!0&&y(v,m?m.concat(x):[x])}),u.pop()}}if(!h.isObject(n))throw new TypeError("data must be an object");return y(n),e}function gr(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Fn(n,e){this._pairs=[],n&&Bt(n,this,e)}const gs=Fn.prototype;gs.append=function(e,t){this._pairs.push([e,t])};gs.toString=function(e){const t=e?function(r){return e.call(this,r,gr)}:gr;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function Eo(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ys(n,e,t){if(!e)return n;const r=t&&t.encode||Eo,s=t&&t.serialize;let a;if(s?a=s(e,t):a=h.isURLSearchParams(e)?e.toString():new Fn(e,t).toString(r),a){const i=n.indexOf("#");i!==-1&&(n=n.slice(0,i)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class yr{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){h.forEach(this.handlers,function(r){r!==null&&e(r)})}}const ws={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Co=typeof URLSearchParams<"u"?URLSearchParams:Fn,vo=typeof FormData<"u"?FormData:null,Po=typeof Blob<"u"?Blob:null,Ro={isBrowser:!0,classes:{URLSearchParams:Co,FormData:vo,Blob:Po},protocols:["http","https","file","blob","url","data"]},Ln=typeof window<"u"&&typeof document<"u",gn=typeof navigator=="object"&&navigator||void 0,No=Ln&&(!gn||["ReactNative","NativeScript","NS"].indexOf(gn.product)<0),jo=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ko=Ln&&window.location.href||"http://localhost",Oo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ln,hasStandardBrowserEnv:No,hasStandardBrowserWebWorkerEnv:jo,navigator:gn,origin:ko},Symbol.toStringTag,{value:"Module"})),ee={...Oo,...Ro};function Io(n,e){return Bt(n,new ee.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,a){return ee.isNode&&h.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function To(n){return h.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Fo(n){const e={},t=Object.keys(n);let r;const s=t.length;let a;for(r=0;r<s;r++)a=t[r],e[a]=n[a];return e}function xs(n){function e(t,r,s,a){let i=t[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),d=a>=t.length;return i=!i&&h.isArray(s)?s.length:i,d?(h.hasOwnProp(s,i)?s[i]=[s[i],r]:s[i]=r,!l):((!s[i]||!h.isObject(s[i]))&&(s[i]=[]),e(t,r,s[i],a)&&h.isArray(s[i])&&(s[i]=Fo(s[i])),!l)}if(h.isFormData(n)&&h.isFunction(n.entries)){const t={};return h.forEachEntry(n,(r,s)=>{e(To(r),s,t,0)}),t}return null}function Lo(n,e,t){if(h.isString(n))try{return(e||JSON.parse)(n),h.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(n)}const ct={transitional:ws,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=h.isObject(e);if(a&&h.isHTMLForm(e)&&(e=new FormData(e)),h.isFormData(e))return s?JSON.stringify(xs(e)):e;if(h.isArrayBuffer(e)||h.isBuffer(e)||h.isStream(e)||h.isFile(e)||h.isBlob(e)||h.isReadableStream(e))return e;if(h.isArrayBufferView(e))return e.buffer;if(h.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Io(e,this.formSerializer).toString();if((l=h.isFileList(e))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Bt(l?{"files[]":e}:e,d&&new d,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),Lo(e)):e}],transformResponse:[function(e){const t=this.transitional||ct.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(h.isResponse(e)||h.isReadableStream(e))return e;if(e&&h.isString(e)&&(r&&!this.responseType||s)){const i=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(i)throw l.name==="SyntaxError"?R.from(l,R.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ee.classes.FormData,Blob:ee.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};h.forEach(["delete","get","head","post","put","patch"],n=>{ct.headers[n]={}});const $o=h.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mo=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(i){s=i.indexOf(":"),t=i.substring(0,s).trim().toLowerCase(),r=i.substring(s+1).trim(),!(!t||e[t]&&$o[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},wr=Symbol("internals");function Ve(n){return n&&String(n).trim().toLowerCase()}function At(n){return n===!1||n==null?n:h.isArray(n)?n.map(At):String(n)}function Do(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Bo=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Zt(n,e,t,r,s){if(h.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!h.isString(e)){if(h.isString(r))return e.indexOf(r)!==-1;if(h.isRegExp(r))return r.test(e)}}function Uo(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function qo(n,e){const t=h.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,a,i){return this[r].call(this,e,s,a,i)},configurable:!0})})}class te{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function a(l,d,c){const f=Ve(d);if(!f)throw new Error("header name must be a non-empty string");const u=h.findKey(s,f);(!u||s[u]===void 0||c===!0||c===void 0&&s[u]!==!1)&&(s[u||d]=At(l))}const i=(l,d)=>h.forEach(l,(c,f)=>a(c,f,d));if(h.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(h.isString(e)&&(e=e.trim())&&!Bo(e))i(Mo(e),t);else if(h.isHeaders(e))for(const[l,d]of e.entries())a(d,l,r);else e!=null&&a(t,e,r);return this}get(e,t){if(e=Ve(e),e){const r=h.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return Do(s);if(h.isFunction(t))return t.call(this,s,r);if(h.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ve(e),e){const r=h.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Zt(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function a(i){if(i=Ve(i),i){const l=h.findKey(r,i);l&&(!t||Zt(r,r[l],l,t))&&(delete r[l],s=!0)}}return h.isArray(e)?e.forEach(a):a(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const a=t[r];(!e||Zt(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const t=this,r={};return h.forEach(this,(s,a)=>{const i=h.findKey(r,a);if(i){t[i]=At(s),delete t[a];return}const l=e?Uo(a):String(a).trim();l!==a&&delete t[a],t[l]=At(s),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return h.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&h.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[wr]=this[wr]={accessors:{}}).accessors,s=this.prototype;function a(i){const l=Ve(i);r[l]||(qo(s,i),r[l]=!0)}return h.isArray(e)?e.forEach(a):a(e),this}}te.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);h.reduceDescriptors(te.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});h.freezeMethods(te);function en(n,e){const t=this||ct,r=e||t,s=te.from(r.headers);let a=r.data;return h.forEach(n,function(l){a=l.call(t,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function bs(n){return!!(n&&n.__CANCEL__)}function He(n,e,t){R.call(this,n??"canceled",R.ERR_CANCELED,e,t),this.name="CanceledError"}h.inherits(He,R,{__CANCEL__:!0});function _s(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new R("Request failed with status code "+t.status,[R.ERR_BAD_REQUEST,R.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Ho(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Ko(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,a=0,i;return e=e!==void 0?e:1e3,function(d){const c=Date.now(),f=r[a];i||(i=c),t[s]=d,r[s]=c;let u=a,w=0;for(;u!==s;)w+=t[u++],u=u%n;if(s=(s+1)%n,s===a&&(a=(a+1)%n),c-i<e)return;const y=f&&c-f;return y?Math.round(w*1e3/y):void 0}}function Wo(n,e){let t=0,r=1e3/e,s,a;const i=(c,f=Date.now())=>{t=f,s=null,a&&(clearTimeout(a),a=null),n.apply(null,c)};return[(...c)=>{const f=Date.now(),u=f-t;u>=r?i(c,f):(s=c,a||(a=setTimeout(()=>{a=null,i(s)},r-u)))},()=>s&&i(s)]}const jt=(n,e,t=3)=>{let r=0;const s=Ko(50,250);return Wo(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,d=i-r,c=s(d),f=i<=l;r=i;const u={loaded:i,total:l,progress:l?i/l:void 0,bytes:d,rate:c||void 0,estimated:c&&l&&f?(l-i)/c:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};n(u)},t)},xr=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},br=n=>(...e)=>h.asap(()=>n(...e)),Jo=ee.hasStandardBrowserEnv?function(){const e=ee.navigator&&/(msie|trident)/i.test(ee.navigator.userAgent),t=document.createElement("a");let r;function s(a){let i=a;return e&&(t.setAttribute("href",i),i=t.href),t.setAttribute("href",i),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=s(window.location.href),function(i){const l=h.isString(i)?s(i):i;return l.protocol===r.protocol&&l.host===r.host}}():function(){return function(){return!0}}(),zo=ee.hasStandardBrowserEnv?{write(n,e,t,r,s,a){const i=[n+"="+encodeURIComponent(e)];h.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),h.isString(r)&&i.push("path="+r),h.isString(s)&&i.push("domain="+s),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vo(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Xo(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Ss(n,e){return n&&!Vo(e)?Xo(n,e):e}const _r=n=>n instanceof te?{...n}:n;function Re(n,e){e=e||{};const t={};function r(c,f,u){return h.isPlainObject(c)&&h.isPlainObject(f)?h.merge.call({caseless:u},c,f):h.isPlainObject(f)?h.merge({},f):h.isArray(f)?f.slice():f}function s(c,f,u){if(h.isUndefined(f)){if(!h.isUndefined(c))return r(void 0,c,u)}else return r(c,f,u)}function a(c,f){if(!h.isUndefined(f))return r(void 0,f)}function i(c,f){if(h.isUndefined(f)){if(!h.isUndefined(c))return r(void 0,c)}else return r(void 0,f)}function l(c,f,u){if(u in e)return r(c,f);if(u in n)return r(void 0,c)}const d={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(c,f)=>s(_r(c),_r(f),!0)};return h.forEach(Object.keys(Object.assign({},n,e)),function(f){const u=d[f]||s,w=u(n[f],e[f],f);h.isUndefined(w)&&u!==l||(t[f]=w)}),t}const As=n=>{const e=Re({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:l}=e;e.headers=i=te.from(i),e.url=ys(Ss(e.baseURL,e.url),n.params,n.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let d;if(h.isFormData(t)){if(ee.hasStandardBrowserEnv||ee.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((d=i.getContentType())!==!1){const[c,...f]=d?d.split(";").map(u=>u.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...f].join("; "))}}if(ee.hasStandardBrowserEnv&&(r&&h.isFunction(r)&&(r=r(e)),r||r!==!1&&Jo(e.url))){const c=s&&a&&zo.read(a);c&&i.set(s,c)}return e},Go=typeof XMLHttpRequest<"u",Yo=Go&&function(n){return new Promise(function(t,r){const s=As(n);let a=s.data;const i=te.from(s.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:c}=s,f,u,w,y,p;function m(){y&&y(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let g=new XMLHttpRequest;g.open(s.method.toUpperCase(),s.url,!0),g.timeout=s.timeout;function v(){if(!g)return;const b=te.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:b,config:n,request:g};_s(function(C){t(C),m()},function(C){r(C),m()},N),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(r(new R("Request aborted",R.ECONNABORTED,n,g)),g=null)},g.onerror=function(){r(new R("Network Error",R.ERR_NETWORK,n,g)),g=null},g.ontimeout=function(){let _=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const N=s.transitional||ws;s.timeoutErrorMessage&&(_=s.timeoutErrorMessage),r(new R(_,N.clarifyTimeoutError?R.ETIMEDOUT:R.ECONNABORTED,n,g)),g=null},a===void 0&&i.setContentType(null),"setRequestHeader"in g&&h.forEach(i.toJSON(),function(_,N){g.setRequestHeader(N,_)}),h.isUndefined(s.withCredentials)||(g.withCredentials=!!s.withCredentials),l&&l!=="json"&&(g.responseType=s.responseType),c&&([w,p]=jt(c,!0),g.addEventListener("progress",w)),d&&g.upload&&([u,y]=jt(d),g.upload.addEventListener("progress",u),g.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(f=b=>{g&&(r(!b||b.type?new He(null,n,g):b),g.abort(),g=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const x=Ho(s.url);if(x&&ee.protocols.indexOf(x)===-1){r(new R("Unsupported protocol "+x+":",R.ERR_BAD_REQUEST,n));return}g.send(a||null)})},Qo=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const a=function(c){if(!s){s=!0,l();const f=c instanceof Error?c:this.reason;r.abort(f instanceof R?f:new He(f instanceof Error?f.message:f))}};let i=e&&setTimeout(()=>{i=null,a(new R(`timeout ${e} of ms exceeded`,R.ETIMEDOUT))},e);const l=()=>{n&&(i&&clearTimeout(i),i=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(a):c.removeEventListener("abort",a)}),n=null)};n.forEach(c=>c.addEventListener("abort",a));const{signal:d}=r;return d.unsubscribe=()=>h.asap(l),d}},Zo=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},el=async function*(n,e){for await(const t of tl(n))yield*Zo(t,e)},tl=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},Sr=(n,e,t,r)=>{const s=el(n,e);let a=0,i,l=d=>{i||(i=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:c,value:f}=await s.next();if(c){l(),d.close();return}let u=f.byteLength;if(t){let w=a+=u;t(w)}d.enqueue(new Uint8Array(f))}catch(c){throw l(c),c}},cancel(d){return l(d),s.return()}},{highWaterMark:2})},Ut=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Es=Ut&&typeof ReadableStream=="function",nl=Ut&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Cs=(n,...e)=>{try{return!!n(...e)}catch{return!1}},rl=Es&&Cs(()=>{let n=!1;const e=new Request(ee.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),Ar=64*1024,yn=Es&&Cs(()=>h.isReadableStream(new Response("").body)),kt={stream:yn&&(n=>n.body)};Ut&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!kt[e]&&(kt[e]=h.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new R(`Response type '${e}' is not supported`,R.ERR_NOT_SUPPORT,r)})})})(new Response);const sl=async n=>{if(n==null)return 0;if(h.isBlob(n))return n.size;if(h.isSpecCompliantForm(n))return(await new Request(ee.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(h.isArrayBufferView(n)||h.isArrayBuffer(n))return n.byteLength;if(h.isURLSearchParams(n)&&(n=n+""),h.isString(n))return(await nl(n)).byteLength},al=async(n,e)=>{const t=h.toFiniteNumber(n.getContentLength());return t??sl(e)},il=Ut&&(async n=>{let{url:e,method:t,data:r,signal:s,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:d,responseType:c,headers:f,withCredentials:u="same-origin",fetchOptions:w}=As(n);c=c?(c+"").toLowerCase():"text";let y=Qo([s,a&&a.toAbortSignal()],i),p;const m=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let g;try{if(d&&rl&&t!=="get"&&t!=="head"&&(g=await al(f,r))!==0){let N=new Request(e,{method:"POST",body:r,duplex:"half"}),E;if(h.isFormData(r)&&(E=N.headers.get("content-type"))&&f.setContentType(E),N.body){const[C,D]=xr(g,jt(br(d)));r=Sr(N.body,Ar,C,D)}}h.isString(u)||(u=u?"include":"omit");const v="credentials"in Request.prototype;p=new Request(e,{...w,signal:y,method:t.toUpperCase(),headers:f.normalize().toJSON(),body:r,duplex:"half",credentials:v?u:void 0});let x=await fetch(p);const b=yn&&(c==="stream"||c==="response");if(yn&&(l||b&&m)){const N={};["status","statusText","headers"].forEach(L=>{N[L]=x[L]});const E=h.toFiniteNumber(x.headers.get("content-length")),[C,D]=l&&xr(E,jt(br(l),!0))||[];x=new Response(Sr(x.body,Ar,C,()=>{D&&D(),m&&m()}),N)}c=c||"text";let _=await kt[h.findKey(kt,c)||"text"](x,n);return!b&&m&&m(),await new Promise((N,E)=>{_s(N,E,{data:_,headers:te.from(x.headers),status:x.status,statusText:x.statusText,config:n,request:p})})}catch(v){throw m&&m(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new R("Network Error",R.ERR_NETWORK,n,p),{cause:v.cause||v}):R.from(v,v&&v.code,n,p)}}),wn={http:_o,xhr:Yo,fetch:il};h.forEach(wn,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Er=n=>`- ${n}`,ol=n=>h.isFunction(n)||n===null||n===!1,vs={getAdapter:n=>{n=h.isArray(n)?n:[n];const{length:e}=n;let t,r;const s={};for(let a=0;a<e;a++){t=n[a];let i;if(r=t,!ol(t)&&(r=wn[(i=String(t)).toLowerCase()],r===void 0))throw new R(`Unknown adapter '${i}'`);if(r)break;s[i||"#"+a]=r}if(!r){const a=Object.entries(s).map(([l,d])=>`adapter ${l} `+(d===!1?"is not supported by the environment":"is not available in the build"));let i=e?a.length>1?`since :
`+a.map(Er).join(`
`):" "+Er(a[0]):"as no adapter specified";throw new R("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:wn};function tn(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new He(null,n)}function Cr(n){return tn(n),n.headers=te.from(n.headers),n.data=en.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),vs.getAdapter(n.adapter||ct.adapter)(n).then(function(r){return tn(n),r.data=en.call(n,n.transformResponse,r),r.headers=te.from(r.headers),r},function(r){return bs(r)||(tn(n),r&&r.response&&(r.response.data=en.call(n,n.transformResponse,r.response),r.response.headers=te.from(r.response.headers))),Promise.reject(r)})}const Ps="1.7.7",$n={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{$n[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const vr={};$n.transitional=function(e,t,r){function s(a,i){return"[Axios v"+Ps+"] Transitional option '"+a+"'"+i+(r?". "+r:"")}return(a,i,l)=>{if(e===!1)throw new R(s(i," has been removed"+(t?" in "+t:"")),R.ERR_DEPRECATED);return t&&!vr[i]&&(vr[i]=!0,console.warn(s(i," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,i,l):!0}};function ll(n,e,t){if(typeof n!="object")throw new R("options must be an object",R.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const a=r[s],i=e[a];if(i){const l=n[a],d=l===void 0||i(l,a,n);if(d!==!0)throw new R("option "+a+" must be "+d,R.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new R("Unknown option "+a,R.ERR_BAD_OPTION)}}const xn={assertOptions:ll,validators:$n},_e=xn.validators;class Pe{constructor(e){this.defaults=e,this.interceptors={request:new yr,response:new yr}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Re(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&xn.assertOptions(r,{silentJSONParsing:_e.transitional(_e.boolean),forcedJSONParsing:_e.transitional(_e.boolean),clarifyTimeoutError:_e.transitional(_e.boolean)},!1),s!=null&&(h.isFunction(s)?t.paramsSerializer={serialize:s}:xn.assertOptions(s,{encode:_e.function,serialize:_e.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=a&&h.merge(a.common,a[t.method]);a&&h.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),t.headers=te.concat(i,a);const l=[];let d=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(d=d&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let f,u=0,w;if(!d){const p=[Cr.bind(this),void 0];for(p.unshift.apply(p,l),p.push.apply(p,c),w=p.length,f=Promise.resolve(t);u<w;)f=f.then(p[u++],p[u++]);return f}w=l.length;let y=t;for(u=0;u<w;){const p=l[u++],m=l[u++];try{y=p(y)}catch(g){m.call(this,g);break}}try{f=Cr.call(this,y)}catch(p){return Promise.reject(p)}for(u=0,w=c.length;u<w;)f=f.then(c[u++],c[u++]);return f}getUri(e){e=Re(this.defaults,e);const t=Ss(e.baseURL,e.url);return ys(t,e.params,e.paramsSerializer)}}h.forEach(["delete","get","head","options"],function(e){Pe.prototype[e]=function(t,r){return this.request(Re(r||{},{method:e,url:t,data:(r||{}).data}))}});h.forEach(["post","put","patch"],function(e){function t(r){return function(a,i,l){return this.request(Re(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Pe.prototype[e]=t(),Pe.prototype[e+"Form"]=t(!0)});class Mn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(s=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](s);r._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(l=>{r.subscribe(l),a=l}).then(s);return i.cancel=function(){r.unsubscribe(a)},i},e(function(a,i,l){r.reason||(r.reason=new He(a,i,l),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Mn(function(s){e=s}),cancel:e}}}function cl(n){return function(t){return n.apply(null,t)}}function ul(n){return h.isObject(n)&&n.isAxiosError===!0}const bn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bn).forEach(([n,e])=>{bn[e]=n});function Rs(n){const e=new Pe(n),t=as(Pe.prototype.request,e);return h.extend(t,Pe.prototype,e,{allOwnKeys:!0}),h.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Rs(Re(n,s))},t}const U=Rs(ct);U.Axios=Pe;U.CanceledError=He;U.CancelToken=Mn;U.isCancel=bs;U.VERSION=Ps;U.toFormData=Bt;U.AxiosError=R;U.Cancel=U.CanceledError;U.all=function(e){return Promise.all(e)};U.spread=cl;U.isAxiosError=ul;U.mergeConfig=Re;U.AxiosHeaders=te;U.formToJSON=n=>xs(h.isHTMLForm(n)?new FormData(n):n);U.getAdapter=vs.getAdapter;U.HttpStatusCode=bn;U.default=U;const dl=async n=>{try{const t=(await U.post("https://api.perplexity.ai/chat/completions",{model:"llama-3.1-sonar-huge-128k-online",messages:[{role:"system",content:`You are a research assistant. Format your response as a JSON array of research findings. 
            Each item should have a "summary" field (a brief overview) and a "details" array (specific points).
            Example format:
            [
              {
                "summary": "Brief overview of the first topic",
                "details": ["Detail 1", "Detail 2", "Detail 3"]
              },
              {
                "summary": "Brief overview of the second topic",
                "details": ["Detail 1", "Detail 2", "Detail 3"]
              }
            ]`},{role:"user",content:`Research the following topic and provide detailed analysis in the specified JSON format: ${n}`}],max_tokens:4e3,temperature:.7},{headers:{Authorization:"Bearer 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","Content-Type":"application/json"}})).data.choices[0].message.content,r=t.match(/\[[\s\S]*\]/);if(r)try{return JSON.parse(r[0])}catch(a){console.error("Failed to parse JSON:",a)}return t.split(`

`).filter(Boolean).map(a=>{const i=a.split(`
`).filter(Boolean);return{summary:i[0].replace(/^[#\-*•]\s*/,""),details:i.slice(1).map(l=>l.replace(/^[#\-*•]\s*/,""))}})}catch(e){throw console.error("Error searching with Perplexity API:",e),U.isAxiosError(e)&&e.response?new Error(`API Error: ${e.response.status} - ${e.response.data.error||"Unknown error"}`):new Error("Failed to fetch search results. Please try again.")}},fl=({results:n,selectedResults:e,onResultSelection:t})=>{const[r,s]=P.useState(new Set),a=l=>e.some(d=>d.summary===l.summary),i=l=>{const d=new Set(r);d.has(l)?d.delete(l):d.add(l),s(d)};return o.jsxs("div",{className:"space-y-4",children:[e.length>0&&o.jsx(Q,{className:"bg-success-50",children:o.jsxs(Z,{children:[o.jsxs("h4",{className:"font-semibold mb-2",children:["Selected Research (",e.length,")"]}),o.jsx("div",{className:"space-y-2",children:e.map((l,d)=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded-lg shadow-sm",children:[o.jsx("p",{className:"text-sm truncate flex-1",children:l.summary}),o.jsx(B,{size:"sm",color:"danger",variant:"flat",onClick:()=>t(l),children:"Remove"})]},`selected-${d}`))})]})}),o.jsx("div",{className:"space-y-2",children:n.map((l,d)=>o.jsx(Q,{className:a(l)?"border-success border-2":"",children:o.jsxs(Z,{className:"p-0",children:[o.jsxs("div",{className:"flex items-center justify-between p-4",children:[o.jsx("div",{className:"flex-1",children:o.jsx("p",{className:"font-medium",children:l.summary})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(B,{size:"sm",color:a(l)?"success":"primary",variant:a(l)?"flat":"solid",onClick:()=>t(l),startContent:a(l)?o.jsx(xi,{size:16}):null,children:a(l)?"Selected":"Select"}),o.jsx(B,{size:"sm",variant:"light",isIconOnly:!0,onClick:()=>i(`result-${d}`),children:o.jsx(bi,{className:`transform transition-transform ${r.has(`result-${d}`)?"rotate-180":""}`})})]})]}),r.has(`result-${d}`)&&o.jsx("div",{className:"px-4 pb-4",children:o.jsx("ul",{className:"list-disc list-inside space-y-1",children:l.details.map((c,f)=>o.jsx("li",{className:"text-sm text-default-600",children:c},f))})})]})},`result-${d}`))})]})},hl=({onSearch:n,isSearching:e,searchError:t,searchResults:r,selectedResults:s,onResultSelection:a,topic:i})=>{const[l,d]=P.useState(i),c=()=>{n(l)};return o.jsx(Q,{children:o.jsx(Z,{className:"gap-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Research Content"}),o.jsx("p",{className:"text-default-600 mb-4",children:"Search for relevant information to enhance your podcast. You can perform multiple searches and select the most relevant content to inform your transcript."})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ie,{value:l,onChange:f=>d(f.target.value),placeholder:"Enter search terms...",description:"Press search to find relevant content",startContent:o.jsx(Ei,{className:"text-default-400",size:20}),className:"flex-1",onKeyPress:f=>{f.key==="Enter"&&(f.preventDefault(),c())}}),o.jsx(B,{onClick:c,color:"primary",isLoading:e,spinner:o.jsx(Qa,{size:"sm"}),className:"min-w-[100px]",children:e?"Searching...":"Search"})]}),t&&o.jsxs("div",{className:"flex items-center gap-2 p-4 bg-danger-50 text-danger rounded-lg",children:[o.jsx(es,{size:20}),o.jsx("p",{children:t})]}),(r.length>0||s.length>0)&&o.jsx(fl,{results:r,selectedResults:s,onResultSelection:a})]})})})},_n="RFC3986",Sn={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},ml="RFC1738",pl=Array.isArray,fe=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),nn=1024,gl=(n,e,t,r,s)=>{if(n.length===0)return n;let a=n;if(typeof n=="symbol"?a=Symbol.prototype.toString.call(n):typeof n!="string"&&(a=String(n)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let i="";for(let l=0;l<a.length;l+=nn){const d=a.length>=nn?a.slice(l,l+nn):a,c=[];for(let f=0;f<d.length;++f){let u=d.charCodeAt(f);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===ml&&(u===40||u===41)){c[c.length]=d.charAt(f);continue}if(u<128){c[c.length]=fe[u];continue}if(u<2048){c[c.length]=fe[192|u>>6]+fe[128|u&63];continue}if(u<55296||u>=57344){c[c.length]=fe[224|u>>12]+fe[128|u>>6&63]+fe[128|u&63];continue}f+=1,u=65536+((u&1023)<<10|d.charCodeAt(f)&1023),c[c.length]=fe[240|u>>18]+fe[128|u>>12&63]+fe[128|u>>6&63]+fe[128|u&63]}i+=c.join("")}return i};function yl(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function Pr(n,e){if(pl(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const wl=Object.prototype.hasOwnProperty,Ns={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},he=Array.isArray,xl=Array.prototype.push,js=function(n,e){xl.apply(n,he(e)?e:[e])},bl=Date.prototype.toISOString,H={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:gl,encodeValuesOnly:!1,format:_n,formatter:Sn[_n],indices:!1,serializeDate(n){return bl.call(n)},skipNulls:!1,strictNullHandling:!1};function _l(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const rn={};function ks(n,e,t,r,s,a,i,l,d,c,f,u,w,y,p,m,g,v){let x=n,b=v,_=0,N=!1;for(;(b=b.get(rn))!==void 0&&!N;){const $=b.get(n);if(_+=1,typeof $<"u"){if($===_)throw new RangeError("Cyclic object value");N=!0}typeof b.get(rn)>"u"&&(_=0)}if(typeof c=="function"?x=c(e,x):x instanceof Date?x=w==null?void 0:w(x):t==="comma"&&he(x)&&(x=Pr(x,function($){return $ instanceof Date?w==null?void 0:w($):$})),x===null){if(a)return d&&!m?d(e,H.encoder,g,"key",y):e;x=""}if(_l(x)||yl(x)){if(d){const $=m?e:d(e,H.encoder,g,"key",y);return[(p==null?void 0:p($))+"="+(p==null?void 0:p(d(x,H.encoder,g,"value",y)))]}return[(p==null?void 0:p(e))+"="+(p==null?void 0:p(String(x)))]}const E=[];if(typeof x>"u")return E;let C;if(t==="comma"&&he(x))m&&d&&(x=Pr(x,d)),C=[{value:x.length>0?x.join(",")||null:void 0}];else if(he(c))C=c;else{const $=Object.keys(x);C=f?$.sort(f):$}const D=l?String(e).replace(/\./g,"%2E"):String(e),L=r&&he(x)&&x.length===1?D+"[]":D;if(s&&he(x)&&x.length===0)return L+"[]";for(let $=0;$<C.length;++$){const O=C[$],A=typeof O=="object"&&typeof O.value<"u"?O.value:x[O];if(i&&A===null)continue;const T=u&&l?O.replace(/\./g,"%2E"):O,X=he(x)?typeof t=="function"?t(L,T):L:L+(u?"."+T:"["+T+"]");v.set(n,_);const G=new WeakMap;G.set(rn,v),js(E,ks(A,X,t,r,s,a,i,l,t==="comma"&&m&&he(x)?null:d,c,f,u,w,y,p,m,g,G))}return E}function Sl(n=H){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||H.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=_n;if(typeof n.format<"u"){if(!wl.call(Sn,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=Sn[t];let s=H.filter;(typeof n.filter=="function"||he(n.filter))&&(s=n.filter);let a;if(n.arrayFormat&&n.arrayFormat in Ns?a=n.arrayFormat:"indices"in n?a=n.indices?"indices":"repeat":a=H.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:H.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:H.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:H.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:H.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?H.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:H.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:H.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:H.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:H.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:H.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:H.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:H.strictNullHandling}}function Al(n,e={}){let t=n;const r=Sl(e);let s,a;typeof r.filter=="function"?(a=r.filter,t=a("",t)):he(r.filter)&&(a=r.filter,s=a);const i=[];if(typeof t!="object"||t===null)return"";const l=Ns[r.arrayFormat],d=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let w=0;w<s.length;++w){const y=s[w];r.skipNulls&&t[y]===null||js(i,ks(t[y],y,l,d,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const f=i.join(r.delimiter);let u=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),f.length>0?u+f:""}const Te="4.70.2";let Rr=!1,rt,Os,Is,An,Ts,Fs,Ls,$s,Ms;function El(n,e={auto:!1}){if(Rr)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(rt)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${rt}'\``);Rr=e.auto,rt=n.kind,Os=n.fetch,Is=n.FormData,An=n.File,Ts=n.ReadableStream,Fs=n.getMultipartRequestOptions,Ls=n.getDefaultAgent,$s=n.fileFromPath,Ms=n.isFsReadStream}class Cl{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function vl({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,a;try{t=fetch,r=Request,s=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,l)=>({...l,body:new Cl(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}rt||El(vl(),{auto:!0});class j extends Error{}class J extends j{constructor(e,t,r,s){super(`${J.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"];const a=t;this.error=a,this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e)return new qt({message:r,cause:Cn(t)});const a=t==null?void 0:t.error;return e===400?new Ds(e,a,r,s):e===401?new Bs(e,a,r,s):e===403?new Us(e,a,r,s):e===404?new qs(e,a,r,s):e===409?new Hs(e,a,r,s):e===422?new Ks(e,a,r,s):e===429?new Ws(e,a,r,s):e>=500?new Js(e,a,r,s):new J(e,a,r,s)}}class ce extends J{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class qt extends J{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class Dn extends qt{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Ds extends J{constructor(){super(...arguments),this.status=400}}class Bs extends J{constructor(){super(...arguments),this.status=401}}class Us extends J{constructor(){super(...arguments),this.status=403}}class qs extends J{constructor(){super(...arguments),this.status=404}}class Hs extends J{constructor(){super(...arguments),this.status=409}}class Ks extends J{constructor(){super(...arguments),this.status=422}}class Ws extends J{constructor(){super(...arguments),this.status=429}}class Js extends J{}class zs extends j{constructor(){super("Could not parse response content as the length limit was reached")}}class Vs extends j{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ne{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=Ne.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(Ne.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new j(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new j(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new j("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ne.NEWLINE_CHARS=new Set([`
`,"\r"]);Ne.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class ge{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const i of Pl(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null){let l;try{l=JSON.parse(i.data)}catch(d){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),d}if(l&&l.error)throw new J(void 0,l.error,void 0,void 0);yield l}else{let l;try{l=JSON.parse(i.data)}catch(d){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),d}if(i.event=="error")throw new J(void 0,l.error,l.message,void 0);yield{event:i.event,data:l}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new ge(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const i=new Ne,l=Xs(e);for await(const d of l)for(const c of i.decode(d))yield c;for(const d of i.flush())yield d}async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const l of s())i||l&&(yield JSON.parse(l));i=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{i||t.abort()}}return new ge(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=a=>({next:()=>{if(a.length===0){const i=r.next();e.push(i),t.push(i)}return a.shift()}});return[new ge(()=>s(e),this.controller),new ge(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new Ts({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:i}=await t.next();if(i)return s.close();const l=r.encode(JSON.stringify(a)+`
`);s.enqueue(l)}catch(a){s.error(a)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*Pl(n,e){if(!n.body)throw e.abort(),new j("Attempted to iterate over a response with no body");const t=new jl,r=new Ne,s=Xs(n.body);for await(const a of Rl(s))for(const i of r.decode(a)){const l=t.decode(i);l&&(yield l)}for(const a of r.flush()){const i=t.decode(a);i&&(yield i)}}async function*Rl(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let a;for(;(a=Nl(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}function Nl(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class jl{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=kl(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function kl(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function Xs(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Gs=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",Ys=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Ht(n),Ht=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",Ol=n=>Ys(n)||Gs(n)||Ms(n);async function Qs(n,e,t){var s;if(n=await n,Ys(n))return n;if(Gs(n)){const a=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Ht(a)?[await a.arrayBuffer()]:[a];return new An(i,e,t)}const r=await Il(n);if(e||(e=Fl(n)??"unknown_file"),!(t!=null&&t.type)){const a=(s=r[0])==null?void 0:s.type;typeof a=="string"&&(t={...t,type:a})}return new An(r,e,t)}async function Il(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(Ht(n))e.push(await n.arrayBuffer());else if(Ll(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${Tl(n)}`);return e}function Tl(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function Fl(n){var e;return sn(n.name)||sn(n.filename)||((e=sn(n.path))==null?void 0:e.split(/[\\/]/).pop())}const sn=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Ll=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Nr=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",Ue=async n=>{const e=await $l(n.body);return Fs(e,n)},$l=async n=>{const e=new Is;return await Promise.all(Object.entries(n||{}).map(([t,r])=>En(e,t,r))),e},En=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(Ol(t)){const r=await Qs(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>En(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>En(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var $e={},Ml=function(n,e,t,r,s){if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t},Dl=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},gt;async function Zs(n){const{response:e}=n;if(n.options.stream)return Me("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):ge.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const a=await e.json();return Me("response",e.status,e.url,e.headers,a),ea(a,e)}const s=await e.text();return Me("response",e.status,e.url,e.headers,s),s}function ea(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Kt extends Promise{constructor(e,t=Zs){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Kt(this.responsePromise,async t=>ea(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Bl{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=an("maxRetries",t),this.timeout=an("timeout",r),this.httpAgent=s,this.fetch=a??Os}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Jl(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Gl()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const a=s&&Ht(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:a}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var m;const{method:r,path:s,query:a,headers:i={}}=e,l=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Nr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,d=this.calculateContentLength(l),c=this.buildURL(s,a);"timeout"in e&&an("timeout",e.timeout);const f=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??Ls(c),w=f+1e3;typeof((m=u==null?void 0:u.options)==null?void 0:m.timeout)=="number"&&w>(u.options.timeout??0)&&(u.options.timeout=w),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:e,headers:i,contentLength:d,retryCount:t});return{req:{method:r,...l&&{body:l},headers:y,...u&&{agent:u},signal:e.signal??null},url:c,timeout:f}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const a={};r&&(a["content-length"]=r);const i=this.defaultHeaders(e);return Ir(a,i),Ir(a,t),Nr(e.body)&&rt!=="node"&&delete a["content-type"],Tr(i,"x-stainless-retry-count")===void 0&&Tr(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(s)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return J.generate(e,t,r,s)}request(e,t=null){return new Kt(this.makeRequest(e,t))}async makeRequest(e,t){var u,w;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:a,url:i,timeout:l}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(a,{url:i,options:r}),Me("request",i,r,a.headers),(u=r.signal)!=null&&u.aborted)throw new ce;const d=new AbortController,c=await this.fetchWithTimeout(i,a,l,d).catch(Cn);if(c instanceof Error){if((w=r.signal)!=null&&w.aborted)throw new ce;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new Dn:new qt({cause:c})}const f=ql(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const x=`retrying, ${t} attempts remaining`;return Me(`response (error; ${x})`,c.status,i,f),this.retryRequest(r,t,f)}const y=await c.text().catch(x=>Cn(x).message),p=zl(y),m=p?void 0:y;throw Me(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,i,f,m),this.makeStatusError(c.status,p,m,f)}return{response:c,options:r,controller:d}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new Ul(this,r,e)}buildURL(e,t){const r=Xl(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return na(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new j(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...i}).finally(()=>{clearTimeout(l)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const a=r==null?void 0:r["retry-after-ms"];if(a){const l=parseFloat(a);Number.isNaN(l)||(s=l)}const i=r==null?void 0:r["retry-after"];if(i&&!s){const l=parseFloat(i);Number.isNaN(l)?s=Date.parse(i)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,l)}return await ut(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),l=1-Math.random()*.25;return i*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Te}`}}class ta{constructor(e,t,r,s){gt.set(this,void 0),Ml(this,gt,e),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new j("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,a]of r)e.url.searchParams.set(s,a);t.query=void 0,t.path=e.url.toString()}return await Dl(this,gt,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(gt=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Ul extends Kt{constructor(e,t,r){super(t,async s=>new r(e,s.response,await Zs(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const ql=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),Hl={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ne=n=>typeof n=="object"&&n!==null&&!na(n)&&Object.keys(n).every(e=>ra(Hl,e)),Kl=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Te,"X-Stainless-OS":kr(Deno.build.os),"X-Stainless-Arch":jr(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Te,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Te,"X-Stainless-OS":kr(process.platform),"X-Stainless-Arch":jr(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=Wl();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Te,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Te,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Wl(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,a=r[2]||0,i=r[3]||0;return{browser:e,version:`${s}.${a}.${i}`}}}return null}const jr=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",kr=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Or;const Jl=()=>Or??(Or=Kl()),zl=n=>{try{return JSON.parse(n)}catch{return}},Vl=new RegExp("^(?:[a-z]+:)?//","i"),Xl=n=>Vl.test(n),ut=n=>new Promise(e=>setTimeout(e,n)),an=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new j(`${n} must be an integer`);if(e<0)throw new j(`${n} must be a positive integer`);return e},Cn=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},yt=n=>{var e,t,r,s;if(typeof process<"u")return((e=$e==null?void 0:$e[n])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,n))==null?void 0:s.trim()};function na(n){if(!n)return!0;for(const e in n)return!1;return!0}function ra(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ir(n,e){for(const t in e){if(!ra(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function Me(n,...e){typeof process<"u"&&($e==null?void 0:$e.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${n}`,...e)}const Gl=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),Yl=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Ql=n=>typeof(n==null?void 0:n.get)=="function",Tr=(n,e)=>{var r;const t=e.toLowerCase();if(Ql(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,i,l)=>i+l.toUpperCase());for(const a of[e,t,e.toUpperCase(),s]){const i=n.get(a);if(i)return i}}for(const[s,a]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a};function on(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}class sa extends ta{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ye extends ta{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}class I{constructor(e){this._client=e}}let aa=class extends I{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Bn=class extends I{constructor(){super(...arguments),this.completions=new aa(this._client)}};Bn.Completions=aa;class ia extends I{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class oa extends I{create(e,t){return this._client.post("/audio/transcriptions",Ue({body:e,...t}))}}class la extends I{create(e,t){return this._client.post("/audio/translations",Ue({body:e,...t}))}}class dt extends I{constructor(){super(...arguments),this.transcriptions=new oa(this._client),this.translations=new la(this._client),this.speech=new ia(this._client)}}dt.Transcriptions=oa;dt.Translations=la;dt.Speech=ia;class Un extends I{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return ne(e)?this.list({},e):this._client.getAPIList("/batches",qn,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class qn extends ye{}Un.BatchesPage=qn;class Hn extends I{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return ne(e)?this.list({},e):this._client.getAPIList("/assistants",Kn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Kn extends ye{}Hn.AssistantsPage=Kn;function Fr(n){return typeof n.parse=="function"}const De=n=>(n==null?void 0:n.role)==="assistant",ca=n=>(n==null?void 0:n.role)==="function",ua=n=>(n==null?void 0:n.role)==="tool";var oe=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},M=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},vn,Et,Ct,Ge,Ye,vt,Qe,xe,Ze,Ot,It,Fe,da;class fa{constructor(){vn.add(this),this.controller=new AbortController,Et.set(this,void 0),Ct.set(this,()=>{}),Ge.set(this,()=>{}),Ye.set(this,void 0),vt.set(this,()=>{}),Qe.set(this,()=>{}),xe.set(this,{}),Ze.set(this,!1),Ot.set(this,!1),It.set(this,!1),Fe.set(this,!1),oe(this,Et,new Promise((e,t)=>{oe(this,Ct,e,"f"),oe(this,Ge,t,"f")}),"f"),oe(this,Ye,new Promise((e,t)=>{oe(this,vt,e,"f"),oe(this,Qe,t,"f")}),"f"),M(this,Et,"f").catch(()=>{}),M(this,Ye,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},M(this,vn,"m",da).bind(this))},0)}_connected(){this.ended||(M(this,Ct,"f").call(this),this._emit("connect"))}get ended(){return M(this,Ze,"f")}get errored(){return M(this,Ot,"f")}get aborted(){return M(this,It,"f")}abort(){this.controller.abort()}on(e,t){return(M(this,xe,"f")[e]||(M(this,xe,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=M(this,xe,"f")[e];if(!r)return this;const s=r.findIndex(a=>a.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(M(this,xe,"f")[e]||(M(this,xe,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{oe(this,Fe,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){oe(this,Fe,!0,"f"),await M(this,Ye,"f")}_emit(e,...t){if(M(this,Ze,"f"))return;e==="end"&&(oe(this,Ze,!0,"f"),M(this,vt,"f").call(this));const r=M(this,xe,"f")[e];if(r&&(M(this,xe,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!M(this,Fe,"f")&&!(r!=null&&r.length)&&Promise.reject(s),M(this,Ge,"f").call(this,s),M(this,Qe,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!M(this,Fe,"f")&&!(r!=null&&r.length)&&Promise.reject(s),M(this,Ge,"f").call(this,s),M(this,Qe,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Et=new WeakMap,Ct=new WeakMap,Ge=new WeakMap,Ye=new WeakMap,vt=new WeakMap,Qe=new WeakMap,xe=new WeakMap,Ze=new WeakMap,Ot=new WeakMap,It=new WeakMap,Fe=new WeakMap,vn=new WeakSet,da=function(e){if(oe(this,Ot,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ce),e instanceof ce)return oe(this,It,!0,"f"),this._emit("abort",e);if(e instanceof j)return this._emit("error",e);if(e instanceof Error){const t=new j(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new j(String(e)))};function ha(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function ft(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function Zl(n,e){return!e||!ma(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:Wn(n,e)}function Wn(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new zs;if(r.finish_reason==="content_filter")throw new Vs;return{...r,message:{...r.message,tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(a=>tc(e,a)))??[],parsed:r.message.content&&!r.message.refusal?ec(e,r.message.content):null}}});return{...n,choices:t}}function ec(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function tc(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:ft(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function nc(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return ft(t)||(t==null?void 0:t.function.strict)||!1}function ma(n){var e;return ha(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>ft(t)||t.type==="function"&&t.function.strict===!0))??!1}function rc(n){for(const e of n??[]){if(e.type!=="function")throw new j(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new j(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Y=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},V,Pn,Tt,Rn,Nn,jn,pa,kn;const Lr=10;class ga extends fa{constructor(){super(...arguments),V.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(ca(e)||ua(e))&&e.content)this._emit("functionCallResult",e.content);else if(De(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(De(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new j("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Y(this,V,"m",Pn).call(this)}async finalMessage(){return await this.done(),Y(this,V,"m",Tt).call(this)}async finalFunctionCall(){return await this.done(),Y(this,V,"m",Rn).call(this)}async finalFunctionCallResult(){return await this.done(),Y(this,V,"m",Nn).call(this)}async totalUsage(){return await this.done(),Y(this,V,"m",jn).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Y(this,V,"m",Tt).call(this);t&&this._emit("finalMessage",t);const r=Y(this,V,"m",Pn).call(this);r&&this._emit("finalContent",r);const s=Y(this,V,"m",Rn).call(this);s&&this._emit("finalFunctionCall",s);const a=Y(this,V,"m",Nn).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",Y(this,V,"m",jn).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Y(this,V,"m",pa).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Wn(a,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var w;const s="function",{function_call:a="auto",stream:i,...l}=t,d=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:c=Lr}=r||{},f={};for(const y of t.functions)f[y.name||y.function.name]=y;const u=t.functions.map(y=>({name:y.name||y.function.name,parameters:y.parameters,description:y.description}));for(const y of t.messages)this._addMessage(y,!1);for(let y=0;y<c;++y){const m=(w=(await this._createChatCompletion(e,{...l,function_call:a,functions:u,messages:[...this.messages]},r)).choices[0])==null?void 0:w.message;if(!m)throw new j("missing message in ChatCompletion response");if(!m.function_call)return;const{name:g,arguments:v}=m.function_call,x=f[g];if(x){if(d&&d!==g){const E=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:s,name:g,content:E});continue}}else{const E=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${u.map(C=>JSON.stringify(C.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:g,content:E});continue}let b;try{b=Fr(x)?await x.parse(v):v}catch(E){this._addMessage({role:s,name:g,content:E instanceof Error?E.message:String(E)});continue}const _=await x.function(b,this),N=Y(this,V,"m",kn).call(this,_);if(this._addMessage({role:s,name:g,content:N}),d)return}}async _runTools(e,t,r){var y,p,m;const s="tool",{tool_choice:a="auto",stream:i,...l}=t,d=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:c=Lr}=r||{},f=t.tools.map(g=>{if(ft(g)){if(!g.$callback)throw new j("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),u={};for(const g of f)g.type==="function"&&(u[g.function.name||g.function.function.name]=g.function);const w="tools"in t?f.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<c;++g){const x=(p=(await this._createChatCompletion(e,{...l,tool_choice:a,tools:w,messages:[...this.messages]},r)).choices[0])==null?void 0:p.message;if(!x)throw new j("missing message in ChatCompletion response");if(!((m=x.tool_calls)!=null&&m.length))return;for(const b of x.tool_calls){if(b.type!=="function")continue;const _=b.id,{name:N,arguments:E}=b.function,C=u[N];if(C){if(d&&d!==N){const O=`Invalid tool_call: ${JSON.stringify(N)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:s,tool_call_id:_,content:O});continue}}else{const O=`Invalid tool_call: ${JSON.stringify(N)}. Available options are: ${Object.keys(u).map(A=>JSON.stringify(A)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:_,content:O});continue}let D;try{D=Fr(C)?await C.parse(E):E}catch(O){const A=O instanceof Error?O.message:String(O);this._addMessage({role:s,tool_call_id:_,content:A});continue}const L=await C.function(D,this),$=Y(this,V,"m",kn).call(this,L);if(this._addMessage({role:s,tool_call_id:_,content:$}),d)return}}}}V=new WeakSet,Pn=function(){return Y(this,V,"m",Tt).call(this).content??null},Tt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(De(t)){const{function_call:r,...s}=t,a={...s,content:t.content??null,refusal:t.refusal??null};return r&&(a.function_call=r),a}}throw new j("stream ended without producing a ChatCompletionMessage with role=assistant")},Rn=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(De(s)&&(s!=null&&s.function_call))return s.function_call;if(De(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},Nn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(ca(t)&&t.content!=null||ua(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},jn=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},pa=function(e){if(e.n!=null&&e.n>1)throw new j("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},kn=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class it extends ga{static runFunctions(e,t,r){const s=new it,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new it,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}_addMessage(e,t=!0){super._addMessage(e,t),De(e)&&e.content&&this._emit("content",e.content)}}const ya=1,wa=2,xa=4,ba=8,_a=16,Sa=32,Aa=64,Ea=128,Ca=256,va=Ea|Ca,Pa=_a|Sa|va|Aa,Ra=ya|wa|Pa,Na=xa|ba,sc=Ra|Na,K={STR:ya,NUM:wa,ARR:xa,OBJ:ba,NULL:_a,BOOL:Sa,NAN:Aa,INFINITY:Ea,MINUS_INFINITY:Ca,INF:va,SPECIAL:Pa,ATOM:Ra,COLLECTION:Na,ALL:sc};class ac extends Error{}class ic extends Error{}function oc(n,e=K.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return lc(n.trim(),e)}const lc=(n,e)=>{const t=n.length;let r=0;const s=w=>{throw new ac(`${w} at position ${r}`)},a=w=>{throw new ic(`${w} at position ${r}`)},i=()=>(u(),r>=t&&s("Unexpected end of input"),n[r]==='"'?l():n[r]==="{"?d():n[r]==="["?c():n.substring(r,r+4)==="null"||K.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||K.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||K.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||K.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||K.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||K.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):f()),l=()=>{const w=r;let y=!1;for(r++;r<t&&(n[r]!=='"'||y&&n[r-1]==="\\");)y=n[r]==="\\"?!y:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(w,++r-Number(y)))}catch(p){a(String(p))}else if(K.STR&e)try{return JSON.parse(n.substring(w,r-Number(y))+'"')}catch{return JSON.parse(n.substring(w,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},d=()=>{r++,u();const w={};try{for(;n[r]!=="}";){if(u(),r>=t&&K.OBJ&e)return w;const y=l();u(),r++;try{const p=i();Object.defineProperty(w,y,{value:p,writable:!0,enumerable:!0,configurable:!0})}catch(p){if(K.OBJ&e)return w;throw p}u(),n[r]===","&&r++}}catch{if(K.OBJ&e)return w;s("Expected '}' at end of object")}return r++,w},c=()=>{r++;const w=[];try{for(;n[r]!=="]";)w.push(i()),u(),n[r]===","&&r++}catch{if(K.ARR&e)return w;s("Expected ']' at end of array")}return r++,w},f=()=>{if(r===0){n==="-"&&K.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(y){if(K.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}a(String(y))}}const w=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(K.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(w,r))}catch{n.substring(w,r)==="-"&&K.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(w,n.lastIndexOf("e")))}catch(p){a(String(p))}}},u=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return i()},$r=n=>oc(n,K.ALL^K.NUM);var Oe=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},F=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},q,we,Ie,Se,ln,wt,cn,un,dn,xt,fn,Mr;class ot extends ga{constructor(e){super(),q.add(this),we.set(this,void 0),Ie.set(this,void 0),Se.set(this,void 0),Oe(this,we,e,"f"),Oe(this,Ie,[],"f")}get currentChatCompletionSnapshot(){return F(this,Se,"f")}static fromReadableStream(e){const t=new ot(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new ot(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var i;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),F(this,q,"m",ln).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of a)F(this,q,"m",cn).call(this,l);if((i=a.controller.signal)!=null&&i.aborted)throw new ce;return this._addChatCompletion(F(this,q,"m",xt).call(this))}async _fromReadableStream(e,t){var i;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),F(this,q,"m",ln).call(this),this._connected();const s=ge.fromReadableStream(e,this.controller);let a;for await(const l of s)a&&a!==l.id&&this._addChatCompletion(F(this,q,"m",xt).call(this)),F(this,q,"m",cn).call(this,l),a=l.id;if((i=s.controller.signal)!=null&&i.aborted)throw new ce;return this._addChatCompletion(F(this,q,"m",xt).call(this))}[(we=new WeakMap,Ie=new WeakMap,Se=new WeakMap,q=new WeakSet,ln=function(){this.ended||Oe(this,Se,void 0,"f")},wt=function(t){let r=F(this,Ie,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},F(this,Ie,"f")[t.index]=r,r)},cn=function(t){var s,a,i,l,d,c,f,u,w,y,p,m,g,v,x;if(this.ended)return;const r=F(this,q,"m",Mr).call(this,t);this._emit("chunk",t,r);for(const b of t.choices){const _=r.choices[b.index];b.delta.content!=null&&((s=_.message)==null?void 0:s.role)==="assistant"&&((a=_.message)!=null&&a.content)&&(this._emit("content",b.delta.content,_.message.content),this._emit("content.delta",{delta:b.delta.content,snapshot:_.message.content,parsed:_.message.parsed})),b.delta.refusal!=null&&((i=_.message)==null?void 0:i.role)==="assistant"&&((l=_.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:b.delta.refusal,snapshot:_.message.refusal}),((d=b.logprobs)==null?void 0:d.content)!=null&&((c=_.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=b.logprobs)==null?void 0:f.content,snapshot:((u=_.logprobs)==null?void 0:u.content)??[]}),((w=b.logprobs)==null?void 0:w.refusal)!=null&&((y=_.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=b.logprobs)==null?void 0:p.refusal,snapshot:((m=_.logprobs)==null?void 0:m.refusal)??[]});const N=F(this,q,"m",wt).call(this,_);_.finish_reason&&(F(this,q,"m",dn).call(this,_),N.current_tool_call_index!=null&&F(this,q,"m",un).call(this,_,N.current_tool_call_index));for(const E of b.delta.tool_calls??[])N.current_tool_call_index!==E.index&&(F(this,q,"m",dn).call(this,_),N.current_tool_call_index!=null&&F(this,q,"m",un).call(this,_,N.current_tool_call_index)),N.current_tool_call_index=E.index;for(const E of b.delta.tool_calls??[]){const C=(g=_.message.tool_calls)==null?void 0:g[E.index];C!=null&&C.type&&((C==null?void 0:C.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=C.function)==null?void 0:v.name,index:E.index,arguments:C.function.arguments,parsed_arguments:C.function.parsed_arguments,arguments_delta:((x=E.function)==null?void 0:x.arguments)??""}):(C==null||C.type,void 0))}}},un=function(t,r){var i,l,d;if(F(this,q,"m",wt).call(this,t).done_tool_calls.has(r))return;const a=(i=t.message.tool_calls)==null?void 0:i[r];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const c=(d=(l=F(this,we,"f"))==null?void 0:l.tools)==null?void 0:d.find(f=>f.type==="function"&&f.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:r,arguments:a.function.arguments,parsed_arguments:ft(c)?c.$parseRaw(a.function.arguments):c!=null&&c.function.strict?JSON.parse(a.function.arguments):null})}else a.type},dn=function(t){var s,a;const r=F(this,q,"m",wt).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const i=F(this,q,"m",fn).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},xt=function(){if(this.ended)throw new j("stream has ended, this shouldn't happen");const t=F(this,Se,"f");if(!t)throw new j("request ended without sending any chunks");return Oe(this,Se,void 0,"f"),Oe(this,Ie,[],"f"),cc(t,F(this,we,"f"))},fn=function(){var r;const t=(r=F(this,we,"f"))==null?void 0:r.response_format;return ha(t)?t:null},Mr=function(t){var r,s,a,i;let l=F(this,Se,"f");const{choices:d,...c}=t;l?Object.assign(l,c):l=Oe(this,Se,{...c,choices:[]},"f");for(const{delta:f,finish_reason:u,index:w,logprobs:y=null,...p}of t.choices){let m=l.choices[w];if(m||(m=l.choices[w]={finish_reason:u,index:w,message:{},logprobs:y,...p}),y)if(!m.logprobs)m.logprobs=Object.assign({},y);else{const{content:E,refusal:C,...D}=y;Object.assign(m.logprobs,D),E&&((r=m.logprobs).content??(r.content=[]),m.logprobs.content.push(...E)),C&&((s=m.logprobs).refusal??(s.refusal=[]),m.logprobs.refusal.push(...C))}if(u&&(m.finish_reason=u,F(this,we,"f")&&ma(F(this,we,"f")))){if(u==="length")throw new zs;if(u==="content_filter")throw new Vs}if(Object.assign(m,p),!f)continue;const{content:g,refusal:v,function_call:x,role:b,tool_calls:_,...N}=f;if(Object.assign(m.message,N),v&&(m.message.refusal=(m.message.refusal||"")+v),b&&(m.message.role=b),x&&(m.message.function_call?(x.name&&(m.message.function_call.name=x.name),x.arguments&&((a=m.message.function_call).arguments??(a.arguments=""),m.message.function_call.arguments+=x.arguments)):m.message.function_call=x),g&&(m.message.content=(m.message.content||"")+g,!m.message.refusal&&F(this,q,"m",fn).call(this)&&(m.message.parsed=$r(m.message.content))),_){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:E,id:C,type:D,function:L,...$}of _){const O=(i=m.message.tool_calls)[E]??(i[E]={});Object.assign(O,$),C&&(O.id=C),D&&(O.type=D),L&&(O.function??(O.function={name:L.name??"",arguments:""})),L!=null&&L.name&&(O.function.name=L.name),L!=null&&L.arguments&&(O.function.arguments+=L.arguments,nc(F(this,we,"f"),O)&&(O.function.parsed_arguments=$r(O.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ge(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function cc(n,e){const{id:t,choices:r,created:s,model:a,system_fingerprint:i,...l}=n,d={...l,id:t,choices:r.map(({message:c,finish_reason:f,index:u,logprobs:w,...y})=>{if(!f)throw new j(`missing finish_reason for choice ${u}`);const{content:p=null,function_call:m,tool_calls:g,...v}=c,x=c.role;if(!x)throw new j(`missing role for choice ${u}`);if(m){const{arguments:b,name:_}=m;if(b==null)throw new j(`missing function_call.arguments for choice ${u}`);if(!_)throw new j(`missing function_call.name for choice ${u}`);return{...y,message:{content:p,function_call:{arguments:b,name:_},role:x,refusal:c.refusal??null},finish_reason:f,index:u,logprobs:w}}return g?{...y,index:u,finish_reason:f,logprobs:w,message:{...v,role:x,content:p,refusal:c.refusal??null,tool_calls:g.map((b,_)=>{const{function:N,type:E,id:C,...D}=b,{arguments:L,name:$,...O}=N||{};if(C==null)throw new j(`missing choices[${u}].tool_calls[${_}].id
${bt(n)}`);if(E==null)throw new j(`missing choices[${u}].tool_calls[${_}].type
${bt(n)}`);if($==null)throw new j(`missing choices[${u}].tool_calls[${_}].function.name
${bt(n)}`);if(L==null)throw new j(`missing choices[${u}].tool_calls[${_}].function.arguments
${bt(n)}`);return{...D,id:C,type:E,function:{...O,name:$,arguments:L}}})}}:{...y,message:{...v,content:p,role:x,refusal:c.refusal??null},finish_reason:f,index:u,logprobs:w}}),created:s,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Zl(d,e)}function bt(n){return JSON.stringify(n)}class Be extends ot{static fromReadableStream(e){const t=new Be(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new Be(null),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new Be(t),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}}let ja=class extends I{parse(e,t){return rc(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>Wn(r,e))}runFunctions(e,t){return e.stream?Be.runFunctions(this._client,e,t):it.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Be.runTools(this._client,e,t):it.runTools(this._client,e,t)}stream(e,t){return ot.createChatCompletion(this._client,e,t)}};class On extends I{constructor(){super(...arguments),this.completions=new ja(this._client)}}(function(n){n.Completions=ja})(On||(On={}));var S=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},re=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},W,In,me,Pt,le,ve,Le,Ee,Ft,se,Rt,Nt,st,et,tt,Dr,Br,Ur,qr,Hr,Kr,Wr;class ue extends fa{constructor(){super(...arguments),W.add(this),In.set(this,[]),me.set(this,{}),Pt.set(this,{}),le.set(this,void 0),ve.set(this,void 0),Le.set(this,void 0),Ee.set(this,void 0),Ft.set(this,void 0),se.set(this,void 0),Rt.set(this,void 0),Nt.set(this,void 0),st.set(this,void 0)}[(In=new WeakMap,me=new WeakMap,Pt=new WeakMap,le=new WeakMap,ve=new WeakMap,Le=new WeakMap,Ee=new WeakMap,Ft=new WeakMap,se=new WeakMap,Rt=new WeakMap,Nt=new WeakMap,st=new WeakMap,W=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new ue;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=ge.fromReadableStream(e,this.controller);for await(const i of s)S(this,W,"m",et).call(this,i);if((a=s.controller.signal)!=null&&a.aborted)throw new ce;return this._addRun(S(this,W,"m",tt).call(this))}toReadableStream(){return new ge(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,a){const i=new ue;return i._run(()=>i._runToolAssistantStream(e,t,r,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,r,s,a){var c;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},d=await e.submitToolOutputs(t,r,l,{...a,signal:this.controller.signal});this._connected();for await(const f of d)S(this,W,"m",et).call(this,f);if((c=d.controller.signal)!=null&&c.aborted)throw new ce;return this._addRun(S(this,W,"m",tt).call(this))}static createThreadAssistantStream(e,t,r){const s=new ue;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const a=new ue;return a._run(()=>a._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return S(this,Rt,"f")}currentRun(){return S(this,Nt,"f")}currentMessageSnapshot(){return S(this,le,"f")}currentRunStepSnapshot(){return S(this,st,"f")}async finalRunSteps(){return await this.done(),Object.values(S(this,me,"f"))}async finalMessages(){return await this.done(),Object.values(S(this,Pt,"f"))}async finalRun(){if(await this.done(),!S(this,ve,"f"))throw Error("Final run was not received.");return S(this,ve,"f")}async _createThreadAssistantStream(e,t,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...r,signal:this.controller.signal});this._connected();for await(const d of i)S(this,W,"m",et).call(this,d);if((l=i.controller.signal)!=null&&l.aborted)throw new ce;return this._addRun(S(this,W,"m",tt).call(this))}async _createAssistantStream(e,t,r,s){var d;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},l=await e.create(t,i,{...s,signal:this.controller.signal});this._connected();for await(const c of l)S(this,W,"m",et).call(this,c);if((d=l.controller.signal)!=null&&d.aborted)throw new ce;return this._addRun(S(this,W,"m",tt).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let a=e[r];if(a==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(on(a)&&on(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...s);continue}for(const i of s){if(!on(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const l=i.index;if(l==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const d=a[l];d==null?a.push(i):a[l]=this.accumulateDelta(d,i)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${a}`);e[r]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,a){return await this._createToolAssistantStream(r,e,t,s,a)}}et=function(e){if(!this.ended)switch(re(this,Rt,e,"f"),S(this,W,"m",Ur).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":S(this,W,"m",Wr).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":S(this,W,"m",Br).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":S(this,W,"m",Dr).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},tt=function(){if(this.ended)throw new j("stream has ended, this shouldn't happen");if(!S(this,ve,"f"))throw Error("Final run has not been received");return S(this,ve,"f")},Dr=function(e){const[t,r]=S(this,W,"m",Hr).call(this,e,S(this,le,"f"));re(this,le,t,"f"),S(this,Pt,"f")[t.id]=t;for(const s of r){const a=t.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,i=t.content[s.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=S(this,Le,"f")){if(S(this,Ee,"f"))switch(S(this,Ee,"f").type){case"text":this._emit("textDone",S(this,Ee,"f").text,S(this,le,"f"));break;case"image_file":this._emit("imageFileDone",S(this,Ee,"f").image_file,S(this,le,"f"));break}re(this,Le,s.index,"f")}re(this,Ee,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(S(this,Le,"f")!==void 0){const s=e.data.content[S(this,Le,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,S(this,le,"f"));break;case"text":this._emit("textDone",s.text,S(this,le,"f"));break}}S(this,le,"f")&&this._emit("messageDone",e.data),re(this,le,void 0,"f")}},Br=function(e){const t=S(this,W,"m",qr).call(this,e);switch(re(this,st,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of r.step_details.tool_calls)a.index==S(this,Ft,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(S(this,se,"f")&&this._emit("toolCallDone",S(this,se,"f")),re(this,Ft,a.index,"f"),re(this,se,t.step_details.tool_calls[a.index],"f"),S(this,se,"f")&&this._emit("toolCallCreated",S(this,se,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":re(this,st,void 0,"f"),e.data.step_details.type=="tool_calls"&&S(this,se,"f")&&(this._emit("toolCallDone",S(this,se,"f")),re(this,se,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Ur=function(e){S(this,In,"f").push(e),this._emit("event",e)},qr=function(e){switch(e.event){case"thread.run.step.created":return S(this,me,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=S(this,me,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ue.accumulateDelta(t,r.delta);S(this,me,"f")[e.data.id]=s}return S(this,me,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":S(this,me,"f")[e.data.id]=e.data;break}if(S(this,me,"f")[e.data.id])return S(this,me,"f")[e.data.id];throw new Error("No snapshot available")},Hr=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=S(this,W,"m",Kr).call(this,a,i)}else t.content[a.index]=a,r.push(a);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Kr=function(e,t){return ue.accumulateDelta(t,e)},Wr=function(e){switch(re(this,Nt,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":re(this,ve,e.data,"f"),S(this,se,"f")&&(this._emit("toolCallDone",S(this,se,"f")),re(this,se,void 0,"f"));break}};class Jn extends I{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return ne(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,zn,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class zn extends ye{}Jn.MessagesPage=zn;class Vn extends I{retrieve(e,t,r,s={},a){return ne(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,r={},s){return ne(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Xn,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Xn extends ye{}Vn.RunStepsPage=Xn;class ht extends I{constructor(){super(...arguments),this.steps=new Vn(this._client)}create(e,t,r){const{include:s,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:a,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return ne(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Gn,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return ue.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const d=i.headers.get("openai-poll-after-ms");if(d){const c=parseInt(d);isNaN(c)||(l=c)}}await ut(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,r){return ue.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const a=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,t,r,s){return ue.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}}class Gn extends ye{}ht.RunsPage=Gn;ht.Steps=Vn;ht.RunStepsPage=Xn;class Ke extends I{constructor(){super(...arguments),this.runs=new ht(this._client),this.messages=new Jn(this._client)}create(e={},t){return ne(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return ue.createThreadAssistantStream(e,this._client.beta.threads,t)}}Ke.Runs=ht;Ke.RunsPage=Gn;Ke.Messages=Jn;Ke.MessagesPage=zn;const uc=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let Yn=class extends I{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},r){return ne(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Wt,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...r,headers:s}).withResponse(),i=a.data;switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const d=a.response.headers.get("openai-poll-after-ms");if(d){const c=parseInt(d);isNaN(c)||(l=c)}}await ut(l);break;case"failed":case"completed":return i}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}};class Wt extends ye{}Yn.VectorStoreFilesPage=Wt;class ka extends I{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return ne(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Wt,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(a.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const d=i.headers.get("openai-poll-after-ms");if(d){const c=parseInt(d);isNaN(c)||(l=c)}}await ut(l);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,i=Math.min(a,t.length),l=this._client,d=t.values(),c=[...r];async function f(w){for(let y of w){const p=await l.files.create({file:y,purpose:"assistants"},s);c.push(p.id)}}const u=Array(i).fill(d).map(f);return await uc(u),await this.createAndPoll(e,{file_ids:c})}}class We extends I{constructor(){super(...arguments),this.files=new Yn(this._client),this.fileBatches=new ka(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return ne(e)?this.list({},e):this._client.getAPIList("/vector_stores",Qn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Qn extends ye{}We.VectorStoresPage=Qn;We.Files=Yn;We.VectorStoreFilesPage=Wt;We.FileBatches=ka;class ke extends I{constructor(){super(...arguments),this.vectorStores=new We(this._client),this.chat=new On(this._client),this.assistants=new Hn(this._client),this.threads=new Ke(this._client)}}ke.VectorStores=We;ke.VectorStoresPage=Qn;ke.Assistants=Hn;ke.AssistantsPage=Kn;ke.Threads=Ke;class Oa extends I{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Ia extends I{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Zn extends I{create(e,t){return this._client.post("/files",Ue({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return ne(e)?this.list({},e):this._client.getAPIList("/files",er,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t==null?void 0:t.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await ut(t),i=await this.retrieve(e),Date.now()-a>r)throw new Dn({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return i}}class er extends sa{}Zn.FileObjectsPage=er;class tr extends I{list(e,t={},r){return ne(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,nr,{query:t,...r})}}class nr extends ye{}tr.FineTuningJobCheckpointsPage=nr;class Je extends I{constructor(){super(...arguments),this.checkpoints=new tr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return ne(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",rr,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return ne(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,sr,{query:t,...r})}}class rr extends ye{}class sr extends ye{}Je.FineTuningJobsPage=rr;Je.FineTuningJobEventsPage=sr;Je.Checkpoints=tr;Je.FineTuningJobCheckpointsPage=nr;class mt extends I{constructor(){super(...arguments),this.jobs=new Je(this._client)}}mt.Jobs=Je;mt.FineTuningJobsPage=rr;mt.FineTuningJobEventsPage=sr;class Ta extends I{createVariation(e,t){return this._client.post("/images/variations",Ue({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ue({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class ar extends I{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ir,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class ir extends sa{}ar.ModelsPage=ir;class Fa extends I{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class La extends I{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,Ue({body:t,...r}))}}class or extends I{constructor(){super(...arguments),this.parts=new La(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}or.Parts=La;var $a;class k extends Bl{constructor({baseURL:e=yt("OPENAI_BASE_URL"),apiKey:t=yt("OPENAI_API_KEY"),organization:r=yt("OPENAI_ORG_ID")??null,project:s=yt("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new j("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:r,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Yl())throw new j(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Oa(this),this.chat=new Bn(this),this.embeddings=new Ia(this),this.files=new Zn(this),this.images=new Ta(this),this.audio=new dt(this),this.moderations=new Fa(this),this.models=new ar(this),this.fineTuning=new mt(this),this.beta=new ke(this),this.batches=new Un(this),this.uploads=new or(this),this._options=i,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Al(e,{arrayFormat:"brackets"})}}$a=k;k.OpenAI=$a;k.DEFAULT_TIMEOUT=6e5;k.OpenAIError=j;k.APIError=J;k.APIConnectionError=qt;k.APIConnectionTimeoutError=Dn;k.APIUserAbortError=ce;k.NotFoundError=qs;k.ConflictError=Hs;k.RateLimitError=Ws;k.BadRequestError=Ds;k.AuthenticationError=Bs;k.InternalServerError=Js;k.PermissionDeniedError=Us;k.UnprocessableEntityError=Ks;k.toFile=Qs;k.fileFromPath=$s;k.Completions=Oa;k.Chat=Bn;k.Embeddings=Ia;k.Files=Zn;k.FileObjectsPage=er;k.Images=Ta;k.Audio=dt;k.Moderations=Fa;k.Models=ar;k.ModelsPage=ir;k.FineTuning=mt;k.Beta=ke;k.Batches=Un;k.BatchesPage=qn;k.Uploads=or;const Jr=[{value:"alloy",label:"Alloy (Neutral)"},{value:"echo",label:"Echo (Deeper, Confident)"},{value:"fable",label:"Fable (Warm, Engaging)"},{value:"onyx",label:"Onyx (Deep, Authoritative)"},{value:"nova",label:"Nova (Clear, Professional)"},{value:"shimmer",label:"Shimmer (Bright, Energetic)"}],dc=[{value:"casual",label:"Casual Conversation"},{value:"formal",label:"Formal Discussion"},{value:"educational",label:"Educational Content"},{value:"humorous",label:"Humorous/Entertainment"},{value:"debate",label:"Debate Format"}],fc=()=>{const{setPodcastConfig:n,setTranscript:e}=P.useContext(Lt),t=je(),{user:r,getApiKeys:s,isOnline:a}=Ae(),[i,l]=P.useState({podcastName:"",voice1Name:"",voice2Name:"",voice1:"echo",voice2:"nova",topic:"",additionalInfo:"",podcastStyle:"",useOnlineSearch:!1}),[d,c]=P.useState(""),[f,u]=P.useState([]),[w,y]=P.useState([]),[p,m]=P.useState(!1),[g,v]=P.useState(""),[x,b]=P.useState(!0),[_,N]=P.useState(!1);P.useEffect(()=>{(async()=>{try{const T=await s();N(!!T&&!!T.openaiKey&&!!T.perplexityKey)}catch(T){console.error("Error checking API keys:",T),c("Failed to check API keys. Please try again later.")}finally{b(!1)}})()},[s]);const E=(A,T)=>{l(X=>({...X,[T]:A}))},C=A=>{l(T=>({...T,useOnlineSearch:A}))},D=async A=>{m(!0),v("");try{const T=await dl(A);u(T)}catch(T){console.error("Error searching:",T),v(T instanceof Error?T.message:"An error occurred while searching")}finally{m(!1)}},L=A=>{y(T=>T.some(G=>G.summary===A.summary)?T.filter(G=>G.summary!==A.summary):[...T,A])},$=async(A,T)=>{try{const X=await s();if(!(X!=null&&X.openaiKey))throw new Error("OpenAI API key is missing");const lr=(await new k({apiKey:X.openaiKey,dangerouslyAllowBrowser:!0}).chat.completions.create({model:"gpt-4o",messages:[{role:"system",content:`You are an AI assistant that generates podcast scripts. The podcast is called "${A.podcastName}". The style of the podcast is ${A.podcastStyle}. The hosts are ${A.voice1Name} and ${A.voice2Name}. Create a natural conversation between them, including proper podcast etiquette. Use [${A.voice1Name.toUpperCase()}] and [${A.voice2Name.toUpperCase()}] to indicate speaker changes. Do not include any stage directions, sound effects, or music cues. The transcript should be at least 1500 words long.`},{role:"user",content:`Generate a podcast script about ${A.topic}. The script should be engaging, informative, and follow good podcast structure and be around 1500 words. Use the following content as a reference if provided: ${A.additionalInfo}

Additional research:
${T}`}],temperature:.7,max_tokens:4e3})).choices[0].message.content;if(!lr)throw new Error("Failed to generate transcript");return lr}catch(X){throw console.error("Error generating transcript:",X),X}},O=async A=>{A.preventDefault();const T=w.map(G=>`${G.summary}
${G.details.join(`
`)}`).join(`

`),X={...i,additionalInfo:[i.additionalInfo,T].filter(Boolean).join(`

`)};n(X),t("/generating-transcript");try{const G=await $(X,T);e(G),t("/transcript")}catch(G){console.error("Failed to generate transcript:",G),c("Failed to generate transcript. Please try again."),t("/config")}};return x?o.jsx("div",{className:"flex justify-center items-center min-h-[200px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):_?o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsx("form",{onSubmit:O,className:"space-y-6",children:o.jsx(Q,{children:o.jsxs(Z,{className:"gap-4",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Configure Your Podcast"}),d&&o.jsx("p",{className:"text-danger",children:d}),!a&&o.jsx("p",{className:"text-warning",children:"You are currently offline. Some features may not work."}),o.jsx(ie,{label:"Podcast Name",value:i.podcastName,onChange:A=>E(A.target.value,"podcastName"),isRequired:!0}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(ie,{label:"Host 1 Name",value:i.voice1Name,onChange:A=>E(A.target.value,"voice1Name"),isRequired:!0}),o.jsx(ie,{label:"Host 2 Name",value:i.voice2Name,onChange:A=>E(A.target.value,"voice2Name"),isRequired:!0}),o.jsx(zt,{label:"Host 1 Voice",selectedKeys:[i.voice1],onChange:A=>E(A.target.value,"voice1"),children:Jr.map(A=>o.jsx(Vt,{value:A.value,children:A.label},A.value))}),o.jsx(zt,{label:"Host 2 Voice",selectedKeys:[i.voice2],onChange:A=>E(A.target.value,"voice2"),children:Jr.map(A=>o.jsx(Vt,{value:A.value,children:A.label},A.value))})]}),o.jsx(ie,{label:"Topic",value:i.topic,onChange:A=>E(A.target.value,"topic"),isRequired:!0}),o.jsx(zt,{label:"Podcast Style",selectedKeys:[i.podcastStyle],onChange:A=>E(A.target.value,"podcastStyle"),isRequired:!0,children:dc.map(A=>o.jsx(Vt,{value:A.value,children:A.label},A.value))}),o.jsx(Za,{isSelected:i.useOnlineSearch,onValueChange:C,children:"Use online search to enrich content"}),i.useOnlineSearch&&o.jsx(hl,{onSearch:D,isSearching:p,searchError:g,searchResults:f,selectedResults:w,onResultSelection:L,topic:i.topic}),o.jsx(B,{type:"submit",color:"primary",size:"lg",className:"w-full",children:"Generate Transcript"})]})})})}):o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsx(Q,{children:o.jsxs(Z,{children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"API Keys Required"}),o.jsx("p",{className:"mb-4",children:"Please set your API keys in your profile before configuring a podcast."}),o.jsx(B,{color:"primary",onClick:()=>t("/profile"),children:"Go to Profile"})]})})})},hc=()=>{const{config:n,transcript:e,setTranscript:t,setAudioUrl:r}=P.useContext(Lt),s=je(),{isOnline:a,getApiKeys:i}=Ae(),[l,d]=P.useState(""),[c,f]=P.useState(e),[u,w]=P.useState(!1);P.useEffect(()=>{(!n||!e)&&s("/config"),f(e)},[n,e,s]);const y=m=>{f(m.target.value)},p=async()=>{if(n){w(!0),d(""),t(c);try{const m=await i();if(!(m!=null&&m.openaiKey))throw new Error("OpenAI API key is missing. Please set it in your profile.");const g=new k({apiKey:m.openaiKey,dangerouslyAllowBrowser:!0}),v=new RegExp(`\\[${n.voice1Name.toUpperCase()}\\]|\\[${n.voice2Name.toUpperCase()}\\]`),x=c.split(v),b=[];for(let E=1;E<x.length;E++){const C=x[E].trim();if(C){const D=E%2===1?n.voice1:n.voice2,$=await(await g.audio.speech.create({model:"tts-1",voice:D,input:C,speed:1})).arrayBuffer();b.push($)}}const _=new Blob(b,{type:"audio/mpeg"}),N=URL.createObjectURL(_);r(N),s("/audio")}catch(m){console.error("Error generating audio:",m),m instanceof Error?d(m.message):d("Failed to generate audio. Please check your internet connection and try again.")}finally{w(!1)}}};return!n||!e?null:o.jsx("div",{className:"max-w-4xl mx-auto",children:o.jsx(Q,{children:o.jsxs(Z,{className:"gap-4",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Edit Podcast Transcript"}),l&&o.jsx("div",{className:"p-4 bg-danger-50 text-danger rounded-lg",children:l}),!a&&o.jsx("div",{className:"p-4 bg-warning-50 text-warning rounded-lg",children:"You are currently offline. Some features may not work."}),o.jsx(ei,{value:c,onChange:y,placeholder:"Generated transcript will appear here...",minRows:15,size:"lg",className:"font-mono"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx(B,{variant:"flat",color:"primary",startContent:o.jsx(ts,{}),onClick:()=>s("/config"),children:"Back to Config"}),o.jsx(B,{color:"primary",className:"flex-1",startContent:o.jsx(Ri,{}),isLoading:u,onClick:p,children:u?"Generating Audio...":"Generate Audio"})]})]})})})},mc=()=>{const{config:n,audioUrl:e}=P.useContext(Lt),t=je();if(P.useEffect(()=>{(!n||!e)&&t("/config")},[n,e,t]),!n||!e)return null;const r={casual:"Casual Conversation",formal:"Formal Discussion",educational:"Educational Content",humorous:"Humorous/Entertainment",debate:"Debate Format"};return o.jsx("div",{className:"max-w-4xl mx-auto p-6",children:o.jsxs(Q,{className:"w-full",children:[o.jsxs(_t,{className:"flex flex-col gap-2",children:[o.jsx("h1",{className:"text-3xl font-bold",children:n.podcastName}),o.jsxs("div",{className:"text-default-600",children:[o.jsxs("p",{children:["Topic: ",n.topic]}),o.jsxs("p",{children:["Style: ",r[n.podcastStyle]||n.podcastStyle]})]})]}),o.jsxs(Z,{className:"space-y-4",children:[o.jsx("div",{className:"w-full bg-default-100 rounded-lg p-4",children:o.jsxs("audio",{controls:!0,className:"w-full",children:[o.jsx("source",{src:e,type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsx(B,{startContent:o.jsx(ts,{}),variant:"flat",color:"primary",className:"flex-1",onClick:()=>t("/transcript"),children:"Edit Transcript"}),o.jsx(B,{as:"a",href:e,download:`${n.podcastName}.mp3`,startContent:o.jsx(_i,{}),color:"success",className:"flex-1",children:"Download Audio"})]})]})]})})},pc=()=>o.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:o.jsx(Q,{className:"w-full max-w-md",children:o.jsxs(Z,{className:"py-10 flex flex-col items-center gap-6",children:[o.jsx(ss,{className:"w-12 h-12 text-primary"}),o.jsx("h1",{className:"text-2xl font-bold text-center",children:"Creating Your Transcript"}),o.jsx("p",{className:"text-gray-600 text-center",children:"Please wait while we generate your podcast transcript..."}),o.jsx(ti,{size:"lg","aria-label":"Loading..."})]})})}),gc=()=>o.jsx("div",{className:"flex justify-center items-center min-h-[200px]",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}),Xe=({children:n})=>{const{user:e}=Ae();return e?o.jsx(o.Fragment,{children:n}):o.jsx(ii,{to:"/login",replace:!0})},yc=()=>{const[n,e]=nt.useState(null),[t,r]=nt.useState(""),[s,a]=nt.useState("");return o.jsx(Lt.Provider,{value:{config:n,transcript:t,audioUrl:s,setPodcastConfig:e,setTranscript:r,setAudioUrl:a},children:o.jsx("div",{className:"flex flex-col min-h-screen bg-background",children:o.jsxs(P.Suspense,{fallback:o.jsx(gc,{}),children:[o.jsx(Ni,{}),o.jsx("main",{className:"flex-grow container mx-auto px-4 py-8",children:o.jsxs(ai,{children:[o.jsx(be,{path:"/",element:o.jsx(ki,{})}),o.jsx(be,{path:"/login",element:o.jsx(Oi,{})}),o.jsx(be,{path:"/register",element:o.jsx(Ii,{})}),o.jsx(be,{path:"/config",element:o.jsx(Xe,{children:o.jsx(fc,{})})}),o.jsx(be,{path:"/generating-transcript",element:o.jsx(Xe,{children:o.jsx(pc,{})})}),o.jsx(be,{path:"/transcript",element:o.jsx(Xe,{children:o.jsx(hc,{})})}),o.jsx(be,{path:"/audio",element:o.jsx(Xe,{children:o.jsx(mc,{})})}),o.jsx(be,{path:"/profile",element:o.jsx(Xe,{children:o.jsx(Ti,{})})})]})}),o.jsx(ji,{})]})})})},wc=()=>o.jsx(gi,{children:o.jsx(Vr,{children:o.jsx(ni,{attribute:"class",defaultTheme:"system",children:o.jsx(pi,{children:o.jsx(si,{children:o.jsx(yc,{})})})})})});try{const n=document.getElementById("root");if(!n)throw new Error("Root element not found");Gr(n).render(o.jsx(nt.StrictMode,{children:o.jsx(Vr,{children:o.jsx(wc,{})})}))}catch(n){console.error("Failed to mount application:",n),document.body.innerHTML=`
    <div style="padding: 20px;">
      <h1 style="color: red;">Application Error</h1>
      <p>Failed to initialize the application. Please refresh the page.</p>
      <pre style="background: #f5f5f5; padding: 10px;">${n instanceof Error?n.message:String(n)}</pre>
    </div>
  `}
//# sourceMappingURL=index-Dfe_2RKp.js.map
